<html lang="en"><head>
  <meta charset="UTF-8">  
  <title>tutorial === Layout</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/tutorial.css">
  <link rel="stylesheet" href="css/tooltip.css">
</head>
<body translate="no">
<div class="l-site">
  <div class="l-nav">
    <nav class="nav">
      <input type="text" placeholder="Search" id="search">
      <div style="clear: both;"></div>
      <!-- nunjucks loop-->
            
<ul class="links">
<!--list-tag-->
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Basics of JEST Framework</a><span class="tooltiptext">Basics of JEST Framework</span>
                  
                    <ul class="linksNested">
                          
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>naming and Folder convention</a><span class="tooltiptext">naming and Folder convention</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>installing JEST</a><span class="tooltiptext">installing JEST</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>ENZYME Configuration and snapshot testing</a><span class="tooltiptext">ENZYME Configuration and snapshot testing</span>
                        
                    </ul>
                
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">small react-test-renderer library with Snapshooting</a><span class="tooltiptext">small react-test-renderer library with Snapshooting</span>
                 
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Enzyme testing</a><span class="tooltiptext">Enzyme testing</span>
                  
                    <ul class="linksNested">
                          
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>Enzyme based snapshooting</a><span class="tooltiptext">Enzyme based snapshooting</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>Event simulators</a><span class="tooltiptext">Event simulators</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>shallow testing</a><span class="tooltiptext">shallow testing</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>Full dom Rendering enzyme mount();</a><span class="tooltiptext">Full dom Rendering enzyme mount();</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>Full render with Jsdom</a><span class="tooltiptext">Full render with Jsdom</span>
                        
                    </ul>
                
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Testing with Enzyme (cheat sheet link)</a><span class="tooltiptext">Testing with Enzyme (cheat sheet link)</span>
                 
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Testing hooks with react-testing-library</a><span class="tooltiptext">Testing hooks with react-testing-library</span>
                  
                    <ul class="linksNested">
                          
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>installation</a><span class="tooltiptext">installation</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>snapshot test</a><span class="tooltiptext">snapshot test</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>alternative to snapshot</a><span class="tooltiptext">alternative to snapshot</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>act wrapper error</a><span class="tooltiptext">act wrapper error</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>selecting DOM elements {container}</a><span class="tooltiptext">selecting DOM elements {container}</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>events (click,change) and react-dom/test-utils</a><span class="tooltiptext">events (click,change) and react-dom/test-utils</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>testing props (callbacks)</a><span class="tooltiptext">testing props (callbacks)</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>testing async custom hook</a><span class="tooltiptext">testing async custom hook</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>testing async custom hook part 2 (simplified)</a><span class="tooltiptext">testing async custom hook part 2 (simplified)</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>async react hook functional component</a><span class="tooltiptext">async react hook functional component</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>waitFor() async react-testing library v10+</a><span class="tooltiptext">waitFor() async react-testing library v10+</span>
                        
                    </ul>
                
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Testing original functions</a><span class="tooltiptext">Testing original functions</span>
                 
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Testing named functions</a><span class="tooltiptext">Testing named functions</span>
                 
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Testing objects and arrays</a><span class="tooltiptext">Testing objects and arrays</span>
                 
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Testing REDUX</a><span class="tooltiptext">Testing REDUX</span>
                  
                    <ul class="linksNested">
                          
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>testing mapStateToProps and mapDispatchToProps</a><span class="tooltiptext">testing mapStateToProps and mapDispatchToProps</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>redux-mock-store with thunk middleware</a><span class="tooltiptext">redux-mock-store with thunk middleware</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>test redux-saga</a><span class="tooltiptext">test redux-saga</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>test redux with react testing libraray</a><span class="tooltiptext">test redux with react testing libraray</span>
                        
                    </ul>
                
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">MOCK functions</a><span class="tooltiptext">MOCK functions</span>
                  
                    <ul class="linksNested">
                          
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>expect() and mock functions</a><span class="tooltiptext">expect() and mock functions</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>JEST function declaration helpers mockReturnValue nad mockReturnValueOnce</a><span class="tooltiptext">JEST function declaration helpers mockReturnValue nad mockReturnValueOnce</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>Jest.fn() mock that returns promise</a><span class="tooltiptext">Jest.fn() mock that returns promise</span>
                        
                    </ul>
                
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">MOCK document.body</a><span class="tooltiptext">MOCK document.body</span>
                 
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Mock custom module using jest.mock</a><span class="tooltiptext">Mock custom module using jest.mock</span>
                  
                    <ul class="linksNested">
                          
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>globally in __mocks__/custom.js</a><span class="tooltiptext">globally in __mocks__/custom.js</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>mocking only in testing-file.spec.js</a><span class="tooltiptext">mocking only in testing-file.spec.js</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>mocking fetch()</a><span class="tooltiptext">mocking fetch()</span>
                        
                    </ul>
                
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Mock entire module stored in node_modules as react-redux</a><span class="tooltiptext">Mock entire module stored in node_modules as react-redux</span>
                  
                    <ul class="linksNested">
                          
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>__mocks__/react-redux.js</a><span class="tooltiptext">__mocks__/react-redux.js</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>mock(&#39;react-redux&#39;, callback)</a><span class="tooltiptext">mock(&#39;react-redux&#39;, callback)</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>override a mock implemanation</a><span class="tooltiptext">override a mock implemanation</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>mock axios globally in __mocks__ folder axios() as method</a><span class="tooltiptext">mock axios globally in __mocks__ folder axios() as method</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>mock axios globally in __mocks__ folder axios() as object axios.get()</a><span class="tooltiptext">mock axios globally in __mocks__ folder axios() as object axios.get()</span>
                        
                    </ul>
                
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Mock entire module stored in node_modules in testing file</a><span class="tooltiptext">Mock entire module stored in node_modules in testing file</span>
                  
                    <ul class="linksNested">
                          
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>mock axios as method axios() locally in testing file</a><span class="tooltiptext">mock axios as method axios() locally in testing file</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>mock axios as object/module axios locally in testing file</a><span class="tooltiptext">mock axios as object/module axios locally in testing file</span>
                        
                    </ul>
                
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">mock es6 fetch call</a><span class="tooltiptext">mock es6 fetch call</span>
                 
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">SpyOn functionality in general</a><span class="tooltiptext">SpyOn functionality in general</span>
                 
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Spy on DOM elements</a><span class="tooltiptext">Spy on DOM elements</span>
                  
                    <ul class="linksNested">
                          
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>spyOn(window, &#39;scrollTo&#39;)</a><span class="tooltiptext">spyOn(window, &#39;scrollTo&#39;)</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>mock create react refference</a><span class="tooltiptext">mock create react refference</span>
                        
                    </ul>
                
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">jest.spyOn(object,method) as alternative to jest.mock()</a><span class="tooltiptext">jest.spyOn(object,method) as alternative to jest.mock()</span>
                  
                    <ul class="linksNested">
                          
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>spyOn(npm_module,method)</a><span class="tooltiptext">spyOn(npm_module,method)</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>spyOn(class,method)</a><span class="tooltiptext">spyOn(class,method)</span>
                        
                    </ul>
                
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Mock Object methods</a><span class="tooltiptext">Mock Object methods</span>
                  
                    <ul class="linksNested">
                          
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>jest.spyOn() with mockRestore()</a><span class="tooltiptext">jest.spyOn() with mockRestore()</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>SpyOn(object,method,&#39;get&#39; or &#39;set&#39;) with restoring test</a><span class="tooltiptext">SpyOn(object,method,&#39;get&#39; or &#39;set&#39;) with restoring test</span>
                        
                    </ul>
                
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">clearing mocks</a><span class="tooltiptext">clearing mocks</span>
                 
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">run only one test</a><span class="tooltiptext">run only one test</span>
                 
      </li>
    
<!--end-list-tag-->
</ul>

       <!-- nunjucks loop-->
    </nav>
  </div>
  <div class="l-page">
    <div class="menu">
      <div class="menu-hamburger"></div>
    </div>
      <!-- nunjucks loop-->
          
<div class="sectionWrapper">
  <div class="sectionContainer">
   
      
      <section  class="band band-b activeSection"  class="band band-b">
          <h1> Basics of JEST Framework </h1> 
          
              <div class="band-container partition first" part="part-1">
                <div class="band-inner">

                  <p>U should create a sepearte folder for your test that follows the same structure as your src directory</p>
                  <div class="codeWraper">
                    <code>================  __tests__ ================

      Intresting fact if you create folder named : src/__tests__ jest will automatically detect that and uses this foler for running test on files.js inside, beside their names , no need to include filename.test.js it could be skipped.

================  __mocks___ ================

this folder will hold mocks for entire modules, the higher the folder exist the more mocks range will be covered. For example if you mock axios manually in src/__mocks__ then axios mock will be available in all src/ directory. So you dont have to mock it individually src/__mocks__ will cover all axios mock , All U need to do is to import axios as you would do to use it in the file as below.

------------ test.js ------------
import axios from &#39;axios&#39;

Jest first will look for __mocks__ version before it will try to execute original axios module


================  __snapshots___ ================

this folder is crated automatically once snapshot is being created

================ ================ ================</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-2">
                <div class="band-inner">

                  <p>jest is a testing framework ceated by facebook and covers most of the cases for testing react applications</p>
                  <div class="codeWraper">
                    <code>================ install JEST by ================

      npm i jest@20.0.4 (this version works with webpack 3 and babel6) latest version needs update on webpack and babel

================ create script in package.json ================

&quot;scripts&quot;: {
    &quot;test&quot;: &quot;jest&quot;
}
================ to run ================

npm run test or npm test;

================ run only one test as  ================

npm test -- -t &#39;react Fragement&#39; 

will run this test(&#39;react Fragement&#39;, () =&gt; {}) so the discription of the test matters


================ to run with watch mode ================

npm test -- --watch 

================ to run a simple test ================ 

const add = (a,b)=&gt; a + b;

test(&#39;should add two numbers&#39;.; ()=&gt; {
const result = add(3,4)
//asserstion 
expect(result).toBe(7);
});
================ ================ ================</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-3">
                <div class="band-inner">

                  <p>Before U need &#39;Enzyme&#39; Airbnb product that is created to enhance testing for React, it uses addtional selectors and enables Snapshot testing, it needs special adapters to work with JEST
          ENZYME allows you to add event handlers of any types to your shallow wrappers.</p>
                  <div class="codeWraper">
                    <code>================ installing enzyme ================

npm i --save-dev 
enzyme@3.10.0 
jest@24.0.0
jest-css-modules@2.0.0
enzyme-adapter-react-16@1.7.1  (at least 1.7.* needed for react 16.8.4 with hooks)
enzyme-to-json@3.3.5 (package that allows you to render clean snapshot containing just Component JSX)
raf@3.3.2  (U need natitve request animation frame that is default in browser since IE 10 but we need that in testing enviroment )


================ configuration needed for Enzyme 3 ================

create a file for JEST configuration in a root of your project;

================ ================ ================ ================

----------------------root/jest.configuration.json--------------

{
  &quot;setupFiles&quot;:[
    &quot;raf/polyfill&quot;,
    &quot;&lt;rootDir&gt;/enzyme.configuration.js&quot;
  ]
}


//update to the file to have clean snapshot set without importing enzyme-to-json in every file
//so use that version 
{
    &quot;setupFiles&quot;: [
        &quot;raf/polyfill&quot;,
        &quot;&lt;rootDir&gt;/enzyme.configuration.js&quot;
    ],
    &quot;snapshotSerializers&quot;: [
        &quot;enzyme-to-json/serializer&quot;
    ]
}

================ ================ ================ ================

create a file for ENZYME configuration in a root directory;

================ ================ ================ ================

----------------------root/enzyme.configuration.js--------------

import Enzyme from &#39;enzyme&#39;;
import Adapter from &#39;enzyme-adapter-react-16&#39;;

Enzyme.configure({ adapter: new Adapter() });


================ ================ ================ ================

update your package.json with a path for jest configuration

================ ================ ================ ================

----------------------root/package.json--------------

&quot;scripts&quot;: {
    &quot;test&quot;: &quot;jest --config=jest.configuration.json&quot;
  },


---------------------------------------------------------------



import React from &#39;react&#39;;
import { shallow } from &#39;enzyme&#39;;
import MyComponent from &#39;./MyComponent&#39;;

describe(&#39;MyComponent&#39;, () =&gt; {
  it(&#39;should render correctly in &quot;debug&quot; mode&#39;, () =&gt; {
    const component = shallow(&lt;MyComponent debug /&gt;);
  
    expect(component).toMatchSnapshot();
  });
});

================ ================ ================</code>
                  </div>
                </div>
              </div>
            

            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> small react-test-renderer library with Snapshooting </h1> 
          

            
              <div class="band-container">
                <div class="band-inner">

                  <p>There is a small package a 
  npm package called &#39;react-test-renderer&#39; for making your component snapshots. No need for Enzyme. BUT
  in only creates static snapshot it doesnt allow to test clicks, mouse events etc. Recommeded by Jest team though</p>
                  <div class="codeWraper">
                    <code>================ installing react-test-renderer ================

npm i react-test-renderer@16.0.0 (U need this version if you work with React 16.* )

================ example snapshot with JEST react-test-renderer no event handlers   ================

import React from &#39;react&#39;;
import Link from &#39;../Link.react&#39;;
import renderer from &#39;react-test-renderer&#39;;

it(&#39;renders correctly&#39;, () =&gt; {
  const tree = renderer
    .create(&lt;Link page=&quot;http://www.facebook.com&quot;&gt;Facebook&lt;/Link&gt;)
    .toJSON();
  expect(tree).toMatchSnapshot();
});

================ ================ ================</code>
                  </div>
                </div>
              </div>
            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Enzyme testing </h1> 
          
              <div class="band-container partition first" part="part-1">
                <div class="band-inner">

                  <p>getting snapshots from Enzyme wrappers</p>
                  <div class="codeWraper">
                    <code>/--- /

import React from &#39;react&#39;;
import { shallow } from &#39;enzyme&#39;;
import MyComponent from &#39;./MyComponent&#39;;

describe(&#39;MyComponent&#39;, () =&gt; {
  it(&#39;should render correctly in &quot;debug&quot; mode&#39;, () =&gt; {
    const component = shallow(&lt;MyComponent debug /&gt;);
  
    expect(component).toMatchSnapshot();
  });
});</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-2">
                <div class="band-inner">

                  <p>Enzyme allows you to simulate events , could be any event as onLoad, click etc.. U need to find DOM element first and attach simulate as U would event as addEbentListener</p>
                  <div class="codeWraper">
                    <code>================ test click event and the outcome ================



//u need to mock your event handler method ( more about mocking in next section)
const eventHandlerCalled = jest.fn(); 

const value = &#39;myValue&#39;;
const wrapper = shallow(&lt;SearchBox
  label=&quot;label&quot;
  // e below is not a real event so if you need to use e.target.value you need to mock it
  eventHandler={e =&gt; (eventHandlerCalled(value))}
/&gt;);

// here we simulate onInput that needs to have event.target.value in handler method so we do;
wrapper.find(&#39;input&#39;).at(0).simulate(&#39;input&#39;, { target: { value } });

// fucntion is called after click;
expect(eventHandlerCalled).toHaveBeenCalledWith(value);




================  ================  ================  ================</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-3">
                <div class="band-inner">

                  <p>shallow testing allows U to render a component on one level , that means any tested components wont be rendered to the snapshot. It donsnt need any addtional library beside deafault jest and enzyme configuration.</p>
                  <div class="codeWraper">
                    <code>================= example of shalow Enzyme method to Snapshot =================

import React from &#39;react&#39;;
import { shallow } from &#39;enzyme&#39;;

// component for snapshot test;
import SimpleButton from &#39;../../../functional/Simplebutton&#39;;

test(&#39;renders correctly&#39;, () =&gt; {
  const wrapper = shallow(&lt;SimpleButton label=&quot;label&quot; action={() =&gt; {}} /&gt;);
  expect(wrapper).toMatchSnapshot();
});

================ ================ ================ ================</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-4">
                <div class="band-inner">

                  <p>U might need to render nested component for full DOM rendering, for that you also need to install a separate libraray , React reccomends jsdom</p>
                  <div class="codeWraper">
                    <code>===== To help you make up your mind, here is a list of APIs that need jsdom =======



-Any browser globals like window and document
-ReactDOM.render()
-TestUtils.renderIntoDocument() (a shortcut for the above)
-mount() in Enzyme




========== example of full rending is the same as shalow but full needs mount() =========

//no addtional configuration is needed Enzyme behind the scene is using jsdom , not external install nedeed;



import React from &#39;react&#39;;
import { shallow, mount } from &#39;enzyme&#39;;

/*
  *@this next line is defined in a root/jest.configuration.js
  *@so no need to import library
*/
// import toJson from &#39;enzyme-to-json&#39;;

// component for snapshot test;
import ToggleButton from &#39;../../../functional/Togglebutton&#39;;

test(&#39;renders correctly&#39;, () =&gt; {
  const wrapper = mount(&lt;ToggleButton
    action={() =&gt; {}}
    label=&quot;sort&quot;
    toggleLabels={[&#39;ASC&#39;, &#39;DESC&#39;]}
    values={[&#39;sortASC&#39;, &#39;sortDESC&#39;]}
  /&gt;);
  expect(wrapper).toMatchSnapshot();
});



============ ============ ============ ============</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-5">
                <div class="band-inner">

                  <p>U can use jsdom framework by creating browser enviroment, if U dont want to use Enzyme mount() method</p>
                  <div class="codeWraper">
                    <code>============ pure jsdom render no enzyme (not recommended) ============

import React from &#39;react&#39;;
import dom from &#39;jsdom&#39;;

test(&#39;User profile&#39;, () =&gt; {
  let component, dom;

  before((done) =&gt; {
    let person = { FirstName:&#39;Richard&#39;, LastName:&#39;Kotze&#39; };
    component = React.render(
      &lt;ProfileBox hint={person} /&gt;,
      document.body,
      () =&gt; {
        setTimeout(done);
      }
    );
  });

  after((done) =&gt; {
    React.unmountComponentAtNode(document.body);
    setTimeout(done);
  });

  expect(&#39;should contain name&#39;, () =&gt; {
    dom = React.findDOMNode(component);
    dom.textContent.should.containEql(&#39;Richard Kotze&#39;);
  });

});

============ ============ ============ ============</code>
                  </div>
                </div>
              </div>
            

            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Testing with Enzyme (cheat sheet link) </h1> 
          

            
              <div class="band-container">
                <div class="band-inner">

                  <p>Enzyme is air bng testing platform that works like jQuery for selecting the DOM structure captured in Enyzme snapshots</p>
                  <div class="codeWraper">
                    <code>/*Ezyme comes with lots of handy selectors which are all set in the link below*/

//copy that link below and paste in browser;

https://tutorial-set.herokuapp.com/views/javascript_tuts/test_jest_enzyme_tuts/Enzyme_cheatsheet.htm

or original one here:

https://devhints.io/enzyme</code>
                  </div>
                </div>
              </div>
            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Testing hooks with react-testing-library </h1> 
          
              <div class="band-container partition first" part="part-1">
                <div class="band-inner">

                  <p>react-testing-library is an alternative to Enzyme who doesnt support hooks out of the box(without mocking some functionality;). React-testing-library is recommended by facebook itself it might even been created by them just like jest. Follow instalation process</p>
                  <div class="codeWraper">
                    <code>/------ react-testing-library----/

npm install --save-dev @testing-library/dom

/---- For accesing dom elements and set expect you also need js-dom ---/

npm install --save-dev @testing-library/jest-dom


/-------------------/</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-2">
                <div class="band-inner">

                  <p>The best way of tracking changes to the jsx hook outcome is to take a picture of it which is called snapshot ;)</p>
                  <div class="codeWraper">
                    <code>/--- copy below for snaphshot testing -------/

//generated to file Snapshot
                  
import React from &#39;react&#39;;
import { render, cleanup } from &#39;@testing-library/react&#39;;
import &#39;@testing-library/jest-dom/extend-expect&#39;;
import Component from &#39;../../SimpleClickUpdate_useState_hook&#39;;

afterEach(cleanup);
  test(&#39;should take a snapshot&#39;, () =&gt; {
    const { asFragment } = render(&lt;Component /&gt;);
    expect(asFragment()).toMatchSnapshot();
  });

//inlineSnapshot

test(&#39;renders a message&#39;, () =&gt; {
  const { container, getByText } = render(&lt;Greeting /&gt;)
  expect(getByText(&#39;Hello, world!&#39;)).toBeInTheDocument()
  expect(container.firstChild).toMatchInlineSnapshot(`
    &lt;h1&gt;Hello, World!&lt;/h1&gt;
  `)
})
/-------------/</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-3">
                <div class="band-inner">

                  <p>if your component is very small then you can use below arlternative just to know it ;0</p>
                  <div class="codeWraper">
                    <code>/--- copy below for snaphshot testing -------/
                  
import React from &#39;react&#39;;
import { render, cleanup } from &#39;@testing-library/react&#39;;
import &#39;@testing-library/jest-dom/extend-expect&#39;;
import Component from &#39;../../SimpleClickUpdate_useState_hook&#39;;

it(&#39;initial state should be zero (0)&#39;, () =&gt; {
    /**
     *
     * @usage: getByTestId is set in jsx as &lt;p data-testid=&quot;counter&quot;&gt;
     *  
     **/
    const { getByTestId } = render(&lt;Component /&gt;);
    expect(getByTestId(&#39;counter&#39;)).toHaveTextContent(&#39;You clicked 0 times&#39;);
  });</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-4">
                <div class="band-inner">

                  <p>update on tests causes the test engine to block once the render changes therefore most
                of the updates are already wrapped in act() method but sometimes you need to still wrap them yourselft</p>
                  <div class="codeWraper">
                    <code>/------  this a great article about it for now----/


http://localhost:1000/views/javascript_tuts/test_jest_enzyme_tuts/RTL_not_wrapped_in_act_error_scenrios.htm


/-------------------/</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-5">
                <div class="band-inner">

                  <p>React testing libray comes with lots of more or less useufull selectors, personaly I prefer use css selectors. U can use them by using 
-----Default Conatainer------
const {container} = render( component {&lt;..props}/&gt;)

Rembeber they want U to use {container} as custom or defualt container that component is being rendered to. as table component as custom container 

/----------/

-----Custom Container-----
const table = document.createElement(&#39;table&#39;)

const { container } = render(&lt;TableBody {...props} /&gt;, {
container: document.body.appendChild(table),
})

/----------/
If you don specify you custom cotainer then is rendered and appended to div element. And that is why we can use here as selector, cause everying is appended to div down</p>
                  <div class="codeWraper">
                    <code>/-------- user container div as document.body --------/



const { container } = render(&lt;CounterComp /&gt;);
const button1 = container.querySelectorAll(&#39;button&#39;)[0];
expect(container.querySelector(&#39;#display&#39;)).toHaveTextContent(
  &#39;You clicked 1 times&#39;
);



/-----other selectors provided by libary -----/



// Matching a string:
const { screen } = render(&lt;CounterComp /&gt;);
screen.getByText(&#39;Hello World&#39;) // full string match
screen.getByText(&#39;llo Worl&#39;, { exact: false }) // substring match
screen.getByText(&#39;hello world&#39;, { exact: false }) // ignore case



---IMPORATANT---

they can be find under ::: queries 
in documenation

---IMPORATANT---</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-6">
                <div class="band-inner">

                  <p>Events have this syntax 


fireEvent[eventName](node: HTMLElement, eventProperties: Object)

const {fireEvent}  from &#39;react-testing-libary&#39;
fireEvent.click(element, {target:{value:&#39;Greg&#39;}})</p>
                  <div class="codeWraper">
                    <code>/-------- depends on the element you have option with events as --------/

fireEvent.click(element, {target:{value:&#39;Greg&#39;}})
fireEvent.change(element, {target:{value:&#39;Greg&#39;}})
fireEvent.keyDown(domNode, { key: &#39;Enter&#39;, code: &#39;Enter&#39; })
fireEvent.keyDown(domNode, { key: &#39;A&#39;, code: &#39;KeyA&#39; })

//submit
const rightClick = { button: 2 }
fireEvent.click(getByText(&#39;Submit&#39;), rightClick)

//events seems to be a bit buggy (except click) with react Testing libraray
//alternative will to to use react-test utils as below 

import { Simulate } from &#39;react-dom/test-utils&#39;;
Simulate.change(maxFilterRadioButton, { target: { value: &#39;max&#39; } } as any)</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-7">
                <div class="band-inner">

                  <p>Once you render a component as 

const { container } = render(&lt;SearchTemperature filterCallback={filterCallbackMock} /&gt;);

 U will send filterCallback prop to the componenent that needs to be tested as below:</p>
                  <div class="codeWraper">
                    <code>/-------- testing callback prop --------/

describe(&#39;on submit temperature form&#39;, () =&gt; {
    it(&#39;should submit search with calling callback method&#39;, () =&gt; {

      const filterCallbackMock = jest.fn()
      const { container } = render(&lt;SearchTemperature filterCallback={filterCallbackMock} /&gt;);
      const { filterInput, buttonSubmit } = getFormElements(container)
      filterInput.value = &#39;30&#39;
      fireEvent.click(buttonSubmit)
      expect(filterCallbackMock).toHaveBeenCalledWith([&#39;min&#39;, 30])

    })
  })</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-8">
                <div class="band-inner">

                  <p>Custom hooks allow you to expose state logic outside to other files. At the moment the only way to test is by @testing-library/react-hooks library which is the  addition to @testing-library/react. Example below</p>
                  <div class="codeWraper">
                    <code>/------------- async custom hook example useAsyncRequest.js -------------------/

import { useState, useEffect } from &quot;react&quot;;
import axios from &quot;axios&quot;;

const useAsyncRequest = (url, initialValue) =&gt; {

  const [data, setData] = useState(initialValue);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {

    const fetchData = async function() {
      try {
        setLoading(true);

        //this hook uses axios.get() to be mocked in test

        const response = await axios.get(url);

        if (response.status === 200) {
          setData(response.data);
        }
      } catch (error) {
        throw error;
      } finally {
        setLoading(false);
      }
    };

    fetchData();

  }, [url]);


  return { loading, data };

};

export default useAsyncRequest;


/------------- test useAsyncRequest.spec.js  -------------------/



/------------    HOW TO TEST IT ?  -----------------/

1. since it is async hook it depend on async http call that needs to be mocked. This hook uses axios library that could be mocked
in 2 ways , described in this document under: MOCK ENTIRE MODULE STORED IN NODE_MODULES ....

  so U might only use jest.mock(&#39;axios&#39;) or call manually axios.get(&#39;path&#39;) to execute call (depend on implementation)

3. Once axios is mocked we need to render our custom hook by twice once before call and second with http response.

  test(&#39;calls http request and show loading status before http response&#39;, ()=&gt;{


    const { result, waitForNextUpdate } = renderHook(() =&gt;
      useCallAPI(query, String(pageNumber))
    );

  })


/------------ /</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-9">
                <div class="band-inner">

                  <p>There are 2 stages for testing async cutom hook before and after data
                  loads. Details below. We need to use

                     const { result,waitForNextUpdate } = renderHook(() =&gt; useFetch());

                    await waitForNextUpdate() will update data for use</p>
                  <div class="codeWraper">
                    <code>/------------- async custom hook example useAsyncRequest.js -------------------/

1. ---- import from seperate react-hooks library -----
import { cleanup, renderHook } from &#39;@testing-library/react-hooks&#39;;


----- mock the fetch for the cutom hook first -----

cosnt mockData = {mockData:&#39;mockData&#39;}
const mockJsonPromise = Promise.resolve(mockData);
const mockFetchPromise = Promise.resolve({
  json: () =&gt; mockJsonPromise,
});



----- testing simple loading status before and after data arrives -------

describe(&#39;useFetch() is loading data&#39;, () =&gt; {
  afterEach(cleanup);
  beforeEach(()=&gt;{
    global.fetch = jest.fn().mockImplementation(() =&gt; mockFetchPromise);
  })
  it(&#39;should set loading=true&#39; , async () =&gt; {
    const { result,waitForNextUpdate } = renderHook(() =&gt; useFetch());
    expect(result.current.loading).toBe(true)
    await waitForNextUpdate()
  });
  it(&#39;should set loading=false once data is loaded&#39; , async () =&gt; {
    const { result,waitForNextUpdate } = renderHook(() =&gt; useFetch());
    await waitForNextUpdate()
    expect(result.current.loading).toBe(false)
  });
}); 

----- testing DATA before and after data arrives -------


describe(&#39;useFetch() responds with data&#39;, () =&gt; {
  afterEach(cleanup);
  beforeEach(()=&gt;{
    global.fetch = jest.fn().mockImplementation(() =&gt; mockFetchPromise);
  })
  it(&#39;should call useFetch() with no params and return data&#39; , async () =&gt; {
    const { result,waitForNextUpdate } = renderHook(() =&gt; useFetch());
    await waitForNextUpdate()
    const mockDataJson = JSON.stringify(mockData.data)
    const hookResponseJson = JSON.stringify(result.current.data)
    expect(hookResponseJson).toBe(mockDataJson)
  });
  it(&#39;should call useFetch({url,location}) with no url,location obj and return data&#39; , async () =&gt; {
    const paramObject = {url:&#39;url&#39;,locations:{&#39;london&#39;: { lon: &#39;-0.118092&#39;, lat: &#39;51.509865&#39; },}};
    const { result,waitForNextUpdate } = renderHook(() =&gt; useFetch(paramObject))
    await waitForNextUpdate()
    const mockDataJson = JSON.stringify(mockDataMultipleLocations)
    const hookResponseJson = JSON.stringify(result.current.data)
    expect(hookResponseJson).toBe(mockDataJson)
  });
}); 


----- testing response comes with error and how it is handled -------

describe(&#39;useFetch() responds with error&#39;, () =&gt; {
  afterEach(cleanup);
  beforeEach(()=&gt;{
    global.fetch = jest.fn().mockImplementation(() =&gt; Promise.reject(&#39;error&#39;));
  })
  it(&#39;should set error&#39; , async () =&gt; {
    const { result,waitForNextUpdate } = renderHook(() =&gt; useFetch());
    await waitForNextUpdate()
    expect(result.current.loading).toBe(false)
    expect(result.current.error).toBe(&#39;error&#39;)
  });
}); 

/-------------/</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-10">
                <div class="band-inner">

                  <p>Async react component needs to be tested before and after response is back. To achive that our test has to be set for async fuction and await the response for update. Details below:</p>
                  <div class="codeWraper">
                    <code>/------------- async App.js -------------------/

import { useState, useEffect } from &quot;react&quot;;
import axios from &quot;axios&quot;;

const App = (url, initialValue) =&gt; {

  const [data, setData] = useState(initialValue);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {

    const fetchData = async function() {
      try {
        setLoading(true);

        //this hook uses axios.get() to be mocked in test

        const response = await axios.get(url);

        if (response.status === 200) {
          setData(response.data);
        }
      } catch (error) {
        throw error;
      } finally {
        setLoading(false);
      }
    };

    fetchData();

  }, [url]);

  return (
    &lt;&gt;
      {!loading &amp;&amp; &#39;loading...&#39;}
      {loading &amp;&amp;  data.map((httpResult)=&gt; httpResult.block )}
    &lt;/&gt;
  );

};

export default App;


-------------- App.spec.tsx test -----------------------

  
1. First step is to check if loading message is present, since this is async component it needs async handling. Wait or 
WaitFor from React testing library will make sure the data is handled correctly in the first step. IMPORTANT wait or waitfor method
in callback returns void 

function waitFor&lt;T&gt;(
  callback: () =&gt; void,
  options?: {
    container?: HTMLElement
    timeout?: number
    interval?: number
    onTimeout?: (error: Error) =&gt; Error
    mutationObserverOptions?: MutationObserverInit
  }
): Promise&lt;T&gt;

Thefore we dont see the ruslt of callback but initial loading state.

describe(&#39;handles async call and shows status of loading&#39;,()=&gt;{
test(&#39;renders &quot;loading...&quot; when data is not returned&#39;, async () =&gt; {
     await act(
      async (): Promise&lt;any&gt; =&gt; {
        const { container, debug } = render(&lt;App /&gt;);

        await wait(() =&gt; {
          debug();
        });

        return container;
      }
    );

  });

test(&#39;updates list when data is returned&#39;, async () =&gt; {
  const { container } = render(&lt;App /&gt;);
    const updatedContainer = await waitForElement(
      async () =&gt; container.outerHTML
    );
    console.log(&#39;updatedContainer&#39;, updatedContainer);

  })


2. test(&#39;updates list...&#39;) uses promise waitForElement that returns updated values, in this case container from render(&#39;&lt;App /&gt;&#39;)
contrary to wait of waitFor that returns void as show above.

function waitForElement&lt;T&gt;(
  callback: () =&gt; T,
  options?: {
    container?: HTMLElement
    timeout?: number
    mutationObserverOptions?: MutationObserverInit
  }
): Promise&lt;T&gt;</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-11">
                <div class="band-inner">

                  <p>in latest versions v10+ most async methods are deprecated and replaced with one waitFor(). Below is example how to use it, the main diffrence is that waitFor() doesnt return result but insted takes async response inside it method as:

                   await waitFor(() =&gt; {
                    const component = asFragment();
                    expect(something);
                  });</p>
                  <div class="codeWraper">
                    <code>//example of snapshot before and after async call 

describe(&#39;should render correctlly with initial props&#39;, () =&gt; {
  it(&#39;should render and take a snapshot before data loads&#39;, () =&gt; {
    const { asFragment } = render(&lt;App /&gt;);
    const firstRender = asFragment();
    expect(firstRender).toMatchSnapshot();
  });
  it(&#39;should render and take a snapshot after data loads&#39;, async () =&gt; {
    //mock list async response
    (List as any).getList = jest.fn().mockReturnValue(List.list);
    const { asFragment } = render(&lt;App /&gt;);
    await waitFor(() =&gt; {
      const component = asFragment();
      expect(component).toMatchSnapshot();
    });
  });
});</code>
                  </div>
                </div>
              </div>
            

            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Testing original functions </h1> 
          

            
              <div class="band-container">
                <div class="band-inner">

                  <p>the most common way of testing functionality of the method is simply run the method and 
                expect to give you back what is declared in function body (method has to be return type!) for that</p>
                  <div class="codeWraper">
                    <code>----------------------- math.js helpers ----------------
export const add      = (a, b) =&gt; a + b;
export const subtract = (a, b) =&gt; b - a;
---------------------------------------------------------

----------------------- app.js (math helpers implementation) ----------------
export const doAdd      = (a, b) =&gt; math.add(a, b);
export const doSubtract = (a, b) =&gt; math.subtract(a, b);
-----------------------------------------------------------------------------

--------------- now testing those implemenations --------------------------
import * as app from &quot;./app&quot;;
import * as math from &quot;./math&quot;;

/*
  *@test base function
  *@by running it
*/
test(&quot;calls math.add&quot;, () =&gt; {
    const add = math.add(1,2)
    expect(add).toBe(3)
})
/*
  *@test higher-order function
  *@by running it
*/
test(&quot;calls app.doAdd&quot;, () =&gt; {
    const appAdd = app.doAdd(1,2)
    expect(appAdd).toBe(3)
})
----------------------------------------------------------------------------</code>
                  </div>
                </div>
              </div>
            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Testing named functions </h1> 
          

            
              <div class="band-container">
                <div class="band-inner">

                  <p>when the function is expored by its name as 

                export const getList = () =&gt; {}

              then to test you need to import entire file first as below:</p>
                  <div class="codeWraper">
                    <code>----------------------- List.js  ----------------

export const getList = () =&gt; {
  console.log(&#39;get list call&#39;);
  return new Promise((resolve) =&gt; {
    setTimeout(() =&gt; {
      resolve(list);
    }, 1000);
  });
};
---------------------------------------------------------



--------------- test.spec.tsx --------------------------

import * as List from &#39;./List.js&#39;;

//typescript 
    (List as any).getList = jest.fn().mockReturnValue(List.list);

})
----------------------------------------------------------------------------</code>
                  </div>
                </div>
              </div>
            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Testing objects and arrays </h1> 
          

            
              <div class="band-container">
                <div class="band-inner">

                  <p>in javascript {}==={} or []===[] are always false , the key is to test what is inside and array or object properties as below</p>
                  <div class="codeWraper">
                    <code>================ 2 objects ================ 

const obj1 = {name:&#39;Greg&#39;}
const obj2 = {name:&#39;Greg&#39;}

obj1===obj2 //false
JSON.stringify(obj1)===JSON.stringify(obj2) //true we comparing to strings

//jest 
describe(&#39;Objects are the same&#39;, () =&gt; {
test(&#39;have all the same properties&#39;, () =&gt; {
  expect(obj1).toEqual(obj2);
});
});


================ ================ ================</code>
                  </div>
                </div>
              </div>
            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Testing REDUX </h1> 
          
              <div class="band-container partition first" part="part-1">
                <div class="band-inner">

                  <p>mapStateToProps and mapDispatchToProps are present in redux containers and the best way of checking if they return correct object is by 
                mocking entire react-redux module that returns {connect, provider} functionality as described below</p>
                  <div class="codeWraper">
                    <code>-------------- U can mock react-redux right in the testing file ----------

/ --------------- /
import the original module as usuall first:
1. -- import react-redux from &#39;react-redux&#39;

2. /---- in any test file as: countryActions.spec.js  ------ /
make your manual inline mocks of react-redux installed by npm install react-redux

jest.mock(&quot;react-redux&quot;, () =&gt; ({
  connect: jest.fn(
    (mapStateToProps, mapDispatchToProps) =&gt; (reactComponent) =&gt; {
      return {
        mapStateToProps,
        mapDispatchToProps,
        component: reactComponent,
      };
    }
  ),
}));

3./ --------------- /
-- lastly import your redux container that uses connect mocked method.

import { ChannelContentContainer } from &quot;../ChannelContentContainer&quot;;

explanation:
when react container componentis imported it will use our mock specify above. Important
You still need to specify you mock_state required by map mapStateToProps.

mock version of react-redux and it could be accessed by:

  mapStateToPropsObject = ChannelContentContainer.mapStateToProps(mock_state);
  mapDispatchToPropsObject = ChannelContentContainer.mapDispatchToProps(()=&gt;console.log(&#39;method send as dispatch&#39;));
  connectedComponent = ChannelContentContainer.component;

/------------------ /

example project using this:::::: dev/REact_studies_examples/redux/saga-thunk-redux-plus-tests

/------------------ /</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-2">
                <div class="band-inner">

                  <p>redux-mock-store allows you to test thunk middleware and action creators as below</p>
                  <div class="codeWraper">
                    <code>/ --- confiture redux-mock-store --- /

import configureStore from &#39;redux-mock-store&#39; //ES6 modules
const { configureStore } = require(&#39;redux-mock-store&#39;) //CommonJS

const middlewares = [thunk]
const mockStore = configureStore(middlewares)

/ ------- /

/ --- then simply dispatch thunk function or action creator ---- /

store.dispatch(fetchData())

//---------------/

explanation:
There is no need to mock action creators that return type object {type:&#39;MY_ACTION_TYPE&#39;} this library will automatically detects and return in store.getActions() U might only mock if action creator dont return object 
or U want to mock entire seperate module that is part of your test code execution.</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-3">
                <div class="band-inner">

                  <p>the best way to  test redux-saga is by using their own method runSaga() or by using external library</p>
                  <div class="codeWraper">
                    <code>/----- original saga generator function ----/

export function* putActiveChannel({ id }) {
  const currentUser = yield select(currentUserSelector);
  const userID = currentUser.get(`id`);
  yield console.log(&quot;sss&quot;, userID);
  yield call(() =&gt; axios.get(`/user/activeChannel/${userID}/${id}`));
}
                  
/ --- test putActiveChannel using  runSaga() --- /
  
    1. /- define state for saga
    const state = { currentUser: { id: &quot;userID&quot; } };
    const id = &quot;test&quot;;


    2. /- run saga will run entire generator function from first to last yield

    runSaga(
      {
        //dispatch: (action) =&gt; dispatched.push(action), //this generator doesnt dispatch action
        getState: () =&gt; state,
      },
      putActiveChannel,
      { id }
    );

    3. /- expect to call our mock axios.get
    expect(axios.get).toHaveBeenCalledTimes(1);
    axios.get().then((result) =&gt; {
      expect(result).toEqual(&quot;hi&quot;);
    });
    const userID = state.currentUser.id;
    expect(axios.get).toHaveBeenCalledWith(
      `/user/activeChannel/${userID}/${id}`
    );

/ ------- /

sample useage file::: REact_studies_examples/redux/saga-thunk-redux-plus-tests/src/sagas/__tests__/activeChannelSaga.spec.js ---

/---/</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-4">
                <div class="band-inner">

                  <p>React testing library allows you to create own wrapper in this
                case store Provider and hook real-application reducer to all action 
                calls will reflect in changes in UI of components</p>
                  <div class="codeWraper">
                    <code>//---------------- example file of custom_render_redux.tsx ---------

// 1.import all needed libraries
import React, { ReactElement } from &#39;react&#39;
import { Provider, } from &#39;react-redux&#39;;
import { createStore, combineReducers } from &#39;redux&#39;
import { render } from &#39;@testing-library/react&#39;
import cartReducer from &#39;../redux/reducers/cart_reducer&#39;
import { basketItemsInterface } from &#39;../redux/reducers/cart_reducer&#39; 


// 2. create iterface of your reducer you will use for testing
export interface ICart {
  cart: {
    items: basketItemsInterface[],
    numberOfItems: number,
  }
}

/* 3.
   start exporing your custom render function from react-render-library
   this fucntion will take 
    =&gt;component (to be wrapped in redux provider)
    //option with property state
    =&gt;options{
      state
        :cart:{initialCart}
      }
    ...other option to pass 

  */


export function renderWithRedux(
  component: ReactElement,
  options: {
    state: ICart,
    [key: string]: any,
  }
) {
  const rootReducer = combineReducers({
    cart: cartReducer,
  })
  
  //create store methot takes reducer and initial store
  const store = createStore(rootReducer, options.state);
  const AllProviders: React.FC&lt;{}&gt; = ({ children }) =&gt;
    &lt;Provider store={store}&gt;
      {children}
    &lt;/Provider&gt;

  // custom wrapped method with wrapper
  const wrappedComponent = render(component, {
    wrapper: AllProviders,
    ...options
  });

  return { store, ...wrappedComponent };
}</code>
                  </div>
                </div>
              </div>
            

            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> MOCK functions </h1> 
          
              <div class="band-container partition first" part="part-1">
                <div class="band-inner">

                  <p>Every function that needs to be tested against:
                      
                        expect(jest.fn()).toBeCalled()
                        expect(jest.fn()).not.toBeCalled()
                        expect(jest.fn()).toBeCalledWith()

                        has to be mocked !! , but that way it will lose its original implemenation, and wont 
                        be called in its original enviroment.</p>
                  <div class="codeWraper">
                    <code>------------ we have Element Component --------

const clickHandler(e){
console.log(&#39;element has been clicked&#39;)
}

const Element = ()=&gt; (&lt;button onClick={clickHandler}&gt;clickMe&lt;/button&gt;)

--------- test Element component --------

component.simulate(&#39;click&#39;)

//to test if click has bee clicked the handler has to mocked or spied on
clickHandler = jest.fn()

now it can be testd for call 

expect(clickHandler).toBeCalled()
expect(clickHandler).not.toBeCalled()
expect(clickHandler).toBeCalledWith()

------------------------</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-2">
                <div class="band-inner">

                  <p>Jest comes with shorthand mock declaration that depends of your usage</p>
                  <div class="codeWraper">
                    <code>------below is the same statement with 2 ways of declaring ------

apiService.get = jest.fn(()=&gt;2) === same as::====   apiService.get = jest.fn().mockReturnValue(2)
apiService.get = jest.fn(()=&gt;2) === same as::====   apiService.get = jest.fn().mockImplemenation(()=&gt;2) //mockImplemenation(()=&gt;2) returns always function


1. ------- once apiService.get is mocked as apiService.get = jest.fn(()=&gt;2)  you can change its mock with diffrent implementation  ------

apiService.get
.mockReturnValueOnce(10)
.mockReturnValueOnce(10)
.mockReturnValue(20);

console.log(apiService.get());
console.log(apiService.get());
console.log(apiService.get());</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-3">
                <div class="band-inner">

                  <p>jest.fn() can return any value so We could introduce async code and return a Promise, usefull for testing HTTP calls</p>
                  <div class="codeWraper">
                    <code>----------------- original apiService.get function -------

apiService.get = (a, b) =&gt; a + b;

--- Assign apiService.get to mock function that returns Promise (it will loose it original functionality);

apiService.get = jest.fn(x =&gt; Promise.resolve(x));


-- make your assortion in Promise callback ----

  apiService.get(2).then((data) =&gt; {
    expect(data).toBe(2);
  });

----------  -----------  --------------</code>
                  </div>
                </div>
              </div>
            

            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> MOCK document.body </h1> 
          

            
              <div class="band-container">
                <div class="band-inner">

                  <p>If you code using elements from the real browser DOME, then you need to tell jest what is your structure 
                  of document.body. Otherwise those elements are null, just like they can not be selected from real DOME and test will crash. So U need to provide those elements to pass the test. This example is for testing form.</p>
                  <div class="codeWraper">
                    <code>/****

** Supposingly U have a code that selects form elements as 

 const form = document.getElementById(formId)

** and then you need form content

const formChildren = form.children

** thefore you need to provide those ellement for jestDOME
*****/

1. The easiset method is to use element.innerHTML();

document.body.innerHTML = `
&lt;form id=&quot;addressForm&quot;&gt;
&lt;input name=&quot;surname&quot;/&gt;
&lt;input name=&quot;name&quot; /&gt;
&lt;/form&gt;`


 2. You can use document.createElement(&#39;tag&#39;) as well. 

 const form = document.createElement(&#39;form&#39;)
 form.setAttribute(&#39;id&#39;, &#39;addressForm&#39;);  

 const input1 = document.createElement(&quot;input&quot;); 
 input1.setAttribute(&#39;type&#39;, &#39;text&#39;); 
 input1.setAttribute(&#39;name&#39;, &#39;surname&#39;); 

 const input2 = document.createElement(&quot;input&quot;); 
 input2.setAttribute(&#39;type&#39;, &#39;text&#39;); 
 input2.setAttribute(&#39;name&#39;, &#39;surname&#39;);

 form.appendChild(input1)
 form.appendChild(input2)
 document.body.appendChild(form)

 --------------------------------</code>
                  </div>
                </div>
              </div>
            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Mock custom module using jest.mock </h1> 
          
              <div class="band-container partition first" part="part-1">
                <div class="band-inner">

                  <p>mock stored in __mocks__/nameofModule.js</p>
                  <div class="codeWraper">
                    <code>// we are intresting in mocking showModal (in practice we will mock entire module anyway cause jest will mock entire file)

-------- original module  modalActions.js -------

export function showModal(children, options = {}) {
  const { mode, type } = options
  return (dispatch) =&gt; {
    dispatch(setModalCancelled(false))
    dispatch(setModalMode(mode || &#39;normal&#39;))
    dispatch(setModalChildren(children))
    dispatch(setModalType(type || &#39;dialog&#39;))
    dispatch(openModal())
  }
}

 By creating a folder __mocks__ and creating mock version of modalActions.js
 / ----- __mocks__/modalActions.js  ------ /

const showModal = jest.fn(() =&gt; ({ type: &#39;MOCK_SHOW_MODAL&#39; }))
export { showModal }


-------------------------------- testingfile.spec.js --------------------------------
1. import your original module as you normally would:
  --- import modalActions.js
2. let jest know you want to use mocked version of modalActions.js
  --- jest.mock(&#39;./pathto/modalActions&#39;)
3. execute code that uses showModal()</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-2">
                <div class="band-inner">

                  <p>this method allows you to mack intant mock in the scope of testing file only.</p>
                  <div class="codeWraper">
                    <code>------ specify method to mock in module -------------


1. import your original module as you normally would:
  --- import {showModal } from  modalActions.js

2. let jest know you want to use mocked version of modalActions.js by specify callback method with mock behaviour

jest.mock(&#39;../modalActions&#39;, () =&gt; ({
  showModal: () =&gt; ({ type: &#39;MOCK_SHOW_MODAL&#39; }),
})) 

3. execute code that uses showModal()  (only this method is mocked from this module)

/ --------------- /


------DONT specify method to mock in module (mock every method) -------------


1. import your original module as you normally would:
  --- import * as all from  modalActions.js

2. let jest know you want to use mocked version of modalActions.js by specify callback method with mock behaviour

jest.mock(&#39;../modalActions&#39;)

3. execute code that uses showModal() or any other method used in this object 
all.showModal()
all.closeModal() etc .. (all of them will be mocked)

/ --------------- /</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-3">
                <div class="band-inner">

                  <p>Custom mock of fetch() native js method for async call</p>
                  <div class="codeWraper">
                    <code>------ Fetch has 2 promises to resolve data  -------------

1. mock resolve()

const mockData = [{data:&#39;data required for resolve&#39;}]

const mockJsonPromise = Promise.resolve(mockData);
//Fetch always resolves with string that needs to be converted to .json()
const mockFetchPromise = Promise.resolve({
  json: () =&gt; mockJsonPromise,
});

----- in test -----

beforeEach(()=&gt;{
  global.fetch = jest.fn().mockImplementation(() =&gt; mockFetchPromise);
})


2. mock reject()

---------eiher reject on first stage of fetch-----------

const mockFetchPromise = Promise.reject({
  json: () =&gt; mockJsonPromise,
});


---------or reject on json() stage ------------

const mockJsonPromise = Promise.reject(&#39;promise rejected&#39;);
const mockFetchPromise = Promise.resolve({
  json: () =&gt; mockJsonPromise,
});

----- in test -----

beforeEach(()=&gt;{
  global.fetch = jest.fn().mockImplementation(() =&gt; mockFetchPromise);
})

/ --------------- /</code>
                  </div>
                </div>
              </div>
            

            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Mock entire module stored in node_modules as react-redux </h1> 
          
              <div class="band-container partition first" part="part-1">
                <div class="band-inner">

                  <p>this is prefelable way of using mock cause it implemanation will be shared accross diffrent files.</p>
                  <div class="codeWraper">
                    <code>----------------------- __mocks__/react-redux.js ----------------


 1. By creating a folder __mocks__ and creating mock version of react-redux

 !!! Name of the file has to match the name for the module so in our case: react-redux.js !!!

 / ----- __mocks__/react-redux.js  ------ /
 //this module we only intrested in connect method from this module so the content will look as below:



//allways need to mock specific to module being used react-router has to exposed export { connect, provider };
//we will use javascript factory to accomplish that!

/-------- IMPORTANT  react-readux --------/

const reactRedux = {
  connect: jest.fn(
    (mapStateToProps, mapDispatchToProps) =&gt; (reactComponent) =&gt; {
      return {
        mapStateToProps,
        mapDispatchToProps,
        component: reactComponent,
      };
    }
  ),
  provider: ({ children }) =&gt; children,
};
const connect = reactRedux.connect;
const provider = reactRedux.provider;

export { connect, provider };


/-------- IMPORTANT axios--------/
//axios has to expose object itself since is imported as import axios from &#39;axios&#39;

export default {
  get: jest.fn(() =&gt; Promise.resolve(&quot;default&quot;)),
};

2./---- in any test file as: countryActions.spec.js  ------ /

tell jest that U want to mock react-redux from node_modules
-- jest.mock(&#39;react-redux&#39;) 



explanation:
when react container component(redux container) is imported it will use our mocked connect method for setting mapStateToProps and mapDispatchToProps.
Remember You still need to specify you mock_state required by map mapStateToProps.


3./---ChannelContentContainer object attached to ChannelContentContainer  due to this:
  --  export const ChannelContentContainer = connect(mapToProps)(dispatchToProps)(component) but also could be done as 
  --  export default connect(mapToProps)(dispatchToProps)(component)

4./-- lastly import your redux container that uses the react-redux connect mock

 -- import { ChannelContentContainer } from &quot;../ChannelContentContainer&quot;; or import  ChannelContentContainer  from &quot;../ChannelContentContainer&quot;
 //depending wchich import used from point 3.

5. /--- now mock version of react-redux and it could be accessed by ---/

  mapStateToPropsObject = ChannelContentContainer.mapStateToProps(mock_state);
  mapDispatchToPropsObject = ChannelContentContainer.mapDispatchToProps(()=&gt;console.log(&#39;method send as dispatch&#39;));
  connectedComponent = ChannelContentContainer.component;


/ ------------------------------------------- /</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-2">
                <div class="band-inner">

                  <p>will mock in the scope of testing file. Disadvantage is that U have to always create mock per test file.</p>
                  <div class="codeWraper">
                    <code>-------------- U can mock react-redux right in the testing file ----------

/ --------------- /
import the original module as usual first:
1. -- import react-redux from &#39;react-redux&#39;

2. /---- in any test file as: countryActions.spec.js  ------ /
make your manual inline mocks of react-redux installed by npm install react-redux

jest.mock(&quot;react-redux&quot;, () =&gt; ({
  connect: jest.fn(
    (mapStateToProps, mapDispatchToProps) =&gt; (reactComponent) =&gt; {
      return {
        mapStateToProps,
        mapDispatchToProps,
        component: reactComponent,
      };
    }
  ),
}));

3./ --------------- /
-- lastly import your redux container that uses connect mocked method.

import { ChannelContentContainer } from &quot;../ChannelContentContainer&quot;;

explanation:
when react container componentis imported it will use our mock specify above. Important
You still need to specify you mock_state required by map mapStateToProps.

mock version of react-redux and it could be accessed by:

  mapStateToPropsObject = ChannelContentContainer.mapStateToProps(mock_state);
  mapDispatchToPropsObject = ChannelContentContainer.mapDispatchToProps(()=&gt;console.log(&#39;method send as dispatch&#39;));
  connectedComponent = ChannelContentContainer.component;

/------------------ /</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-3">
                <div class="band-inner">

                  <p>most of a time U would use your default implemantion residing in __mocks__/modulename.js but occasionly U want specific behaviour for 
                  the module thefore in you test file you can customize it.</p>
                  <div class="codeWraper">
                    <code>1. -- import to module you want to mock as ---

  import axios from &#39;axios&#39;

2. -- let jest know we want to use mock for this module 

  jest.mock(&#39;axios&#39;)

3. override default mock implemenation by overiding its content for example for get method in axios:

  axios.get.mockImpenationOnce(()=&gt;{hello:&#39;I want this implemanation&#39;})

/------------------ /</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-4">
                <div class="band-inner">

                  <p>Any module/library can be mocked either globally or localy in the file. this example shows how to mock axios as axios module with get,put,post  methods etc.</p>
                  <div class="codeWraper">
                    <code>----- file using axios ---------

axios({
  method: &#39;GET&#39;,
  url: &#39;https://api.harvardartmuseums.org/object?&#39;,
  params: { classification: query, page: pageNumber },
  paramsSerializer: function (params) { return `${params.classification}page=${params.page}`}
})
.then((data) =&gt; {
  const { records } = data.data;
})
.catch((error) =&gt; {
  throw new Error(&#39;no net&#39;);
});


--------------
this implementation of axios requires axios() as method and U need to mock with this pattern
-----------------------

------ test --------

1. create file __mocks__/axios.js

-------------_mocks__/axios.js -----------

export default () =&gt; {
  return Promise.resolve({
    data: {
      records: [
        {
          title: &#39;title&#39;,
          images: [],
          century: &#39;21&#39;,
          division: &#39;general&#39;,
        },
        {
          title: &#39;title&#39;,
          images: [],
          century: &#39;21&#39;,
          division: &#39;general&#39;,
        },
      ],
    },
});
};

----- Above file is exported by default as method that returns promise ----------

/------------------------- test.spec.js --------/

2.let jest know that you want to use mock axios by below syntax 

jest.mock(&#39;axios&#39;);

3.depending of the implementation call you mock axios (optional depends on the implementation)

axios({}).then(()=&gt;{
  //your assertion
})


/-------------------------/</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-5">
                <div class="band-inner">

                  <p>Any module/library can be mocked either globally or localy in the file. this example shows how to mock axios as axios() method.</p>
                  <div class="codeWraper">
                    <code>----- file using axios ---------

axios.get(&#39;/path&#39;)
.then((data) =&gt; {
  const { records } = data.data;
})
.catch((error) =&gt; {
  throw new Error(&#39;no net&#39;);
});


--------------
this implementation of axios requires axios as object with methods and U need to mock with this pattern
-----------------------

------ test --------

1. create file __mocks__/axios.js

-------------_mocks__/axios.js -----------

export default {
  get: jest.fn(() =&gt; {
    return Promise.resolve({
      data: {
        records: [
          {
            title: &#39;title&#39;,
            images: [],
            century: &#39;21&#39;,
            division: &#39;general&#39;,
          },
          {
            title: &#39;title&#39;,
            images: [],
            century: &#39;21&#39;,
            division: &#39;general&#39;,
          },
        ],
      },
  }),
};

----- Above file is exported by default as method that returns promise ----------

/------------------------- test.spec.js --------/

2.let jest know that you want to use mock axios by below syntax 

jest.mock(&#39;axios&#39;);

3.depending of the implementation call you mock axios (optional depends on the implementation)

axios.get(&#39;/path&#39;).then(()=&gt;{
  //your assertion
})


/-------------------------/</code>
                  </div>
                </div>
              </div>
            

            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Mock entire module stored in node_modules in testing file </h1> 
          
              <div class="band-container partition first" part="part-1">
                <div class="band-inner">

                  <p>Any module/library can be mocked either globally or localy in the file. this example shows how to mock axios as axios module with get,put,post  methods etc. only in testing file with jest.mock(&#39;library&#39;,()=&gt;{ /* mock funtionality */})</p>
                  <div class="codeWraper">
                    <code>----- file using axios ---------

axios({
  method: &#39;GET&#39;,
  url: &#39;https://api.harvardartmuseums.org/object?&#39;,
  params: { classification: query, page: pageNumber },
  paramsSerializer: function (params) { return `${params.classification}page=${params.page}`}
})
.then((data) =&gt; {
  const { records } = data.data;
})
.catch((error) =&gt; {
  throw new Error(&#39;no net&#39;);
});


--------------
this implementation of axios requires axios() as method and U need to mock with this pattern
-----------------------


1. in testing file use callback of jest.mock(&#39;library&#39;,()=&gt;{ /* mock funtionality */}

------------- test.spec.js -----------

jest.mock(&#39;axios&#39;, () =&gt; {
  return () =&gt;
    Promise.resolve({
      data: {
        records: [
          {
            title: &#39;title&#39;,
            images: [],
            century: &#39;21&#39;,
            division: &#39;general&#39;,
          },
          {
            title: &#39;title&#39;,
            images: [],
            century: &#39;21&#39;,
            division: &#39;general&#39;,
          },
        ],
      },
    });
});

---------------------------


3.depending of the implementation call your mock axios (optional depends on the implementation)

axios({}).then(()=&gt;{
  //your assertion
})


/-------------------------/</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-2">
                <div class="band-inner">

                  <p>Any module/library can be mocked either globally or localy in the file. this example shows how to mock axios as axios obeject with custom method as axios.get() axios.post() etc</p>
                  <div class="codeWraper">
                    <code>----- file using axios ---------

axios.get(&#39;/path&#39;)
.then((data) =&gt; {
  const { records } = data.data;
})
.catch((error) =&gt; {
  throw new Error(&#39;no net&#39;);
});


--------------
this implementation of axios requires axios as object with methods and U need to mock with this pattern
-----------------------


1. in testing file use callback of jest.mock(&#39;library&#39;,()=&gt;{ /* mock funtionality */}

/------------------------- test.spec.js that mocks only get() method --------/

jest.mock(&#39;axios&#39;, () =&gt; ({
  get: jest.fn(() =&gt; {
    return Promise.resolve({
      data: {
        records: [
          {
            title: &#39;title&#39;,
            images: [],
            century: &#39;21&#39;,
            division: &#39;general&#39;,
          },
          {
            title: &#39;title&#39;,
            images: [],
            century: &#39;21&#39;,
            division: &#39;general&#39;,
          },
        ],
      },
    });
  }),
}));


2.depending of the implementation call your mock axios (optional depends on the implementation)

axios.get(&#39;/path&#39;)
.then(()=&gt;{
  //your assertion
})
.catch(e=&gt;trow new Error(e))


/-------------------------/</code>
                  </div>
                </div>
              </div>
            

            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> mock es6 fetch call </h1> 
          

            
              <div class="band-container">
                <div class="band-inner">

                  <p>fetch is a modern ajax call for js, it is is attached to the window.fetch. The approach here is to mock it in __mocks__/fetch.js folder so in can be used everywhere that needs to be mocked as below:</p>
                  <div class="codeWraper">
                    <code>/---------/


1. /- mock it globally 

------- __mocks__/fetch.js ---------


global.fetch = jest.fn().mockImplementation(() =&gt;
  Promise.resolve({
    json: () =&gt; {
      return {
        response: &quot;success&quot;,
      };
    },
  })
);
export default global.fetch;


------------------------

2. /- let jest know U want to use fetch mock not the original js one

jest.mock(&quot;../../__mocks__/fetch&quot;);

3. /- import fetch if you want to test against it
/-------/

import fetch from &quot;../../__mocks__/fetch&quot;;

by expect(fetch).toEqual(...)


/-------/

test example file::: REact_studies_examples/redux/saga-thunk-redux-plus-tests/src/sagas/__tests__/channelSaga.spec.js

/------/</code>
                  </div>
                </div>
              </div>
            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> SpyOn functionality in general </h1> 
          

            
              <div class="band-container">
                <div class="band-inner">

                  <p>SpyOn method allows you to spy on specific method of the object. There are 2 variations:

                1.    jest.spyOn(object, method) 

                  =&gt; this way we will execute original implementation the function will be executed in the code 
                as normla 

                2.     jest.spyOn(object, method).mockImplentation(()=&gt;{}) 

                =&gt; function wont be executed as normal but it could restored later. But at the
                time of execution is exactly the same as:

                    jest.spyOn(object, method).mockImplentation(()=&gt;{}) === object.method = jest.fn(()=&gt;{})</p>
                  <div class="codeWraper">
                    <code>----------- original method -------

function(scrollTo){
  window.scrollTo(scrollTo)
}

-----------------------

--------- first variation ------------

1. / -- if U try to test that it will break cause window method is not defined , one way is to spy on it

const scrollToMethod = jest.spyOn(global.window,&#39;scrollTo&#39;)

//this method it will be executed as normal and will throw the error. In order to pass it, it needs mocking window.scroll additionally

window.scroll = jest.fn()

2. /-- test function(scrollTo)

it(&#39;calls scroll window method&#39;()=&gt;{

expect(scrollTo(20)).tobeCalledWith(20)

})

--------- second variation ------------

1. / -- if U try to test that it will break cause window method is not defined , one way is to spy on it and return mock implementation (the original implementation is not executed !)

const scrollToMethod = jest.spyOn(global.window,&#39;scrollTo&#39;).mockImplementation((scroll)=&gt;&#39;is scrolled to&#39;+scroll)

2. /-- test function(scrollTo)

it(&#39;calls scroll window method&#39;()=&gt;{

expect(scrollTo(20)).toEqual(&#39;is scrolled to 20&#39;);

})

/ ----------------------- /</code>
                  </div>
                </div>
              </div>
            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Spy on DOM elements </h1> 
          
              <div class="band-container partition first" part="part-1">
                <div class="band-inner">

                  <p>spy is perfect for spying on DOM elements. So window is not an exception. The syntax looks ad below 
                  spyOn(window, &#39;scrollTo&#39;).mockImplementationOnce(()=&gt;{})

                  remember:: ---- mockImplementationOnce(()=&gt;{}) needs to return a function -----</p>
                  <div class="codeWraper">
                    <code>/---- good place to mock window is in beforeAll() jest global method to mock it for all tests ------
        
beforeAll(() =&gt; {

  jest.spyOn(window, &quot;scrollTo&quot;).mockImplementation(() =&gt; {});
                              //or
                              //.mockImplementation(jest.fn());
                              //.mockImplementation(() =&gt; jest.fn());

  ---IMPORTANT--


});
jest.spyOn(window, &quot;scrollTo&quot;).mockImplementation(() =&gt; {}); === window.scrollTo = jest.fn(()=&gt;{})

but if you used spy.On() U can still restore original implementation 

window.scrollTo.mockClear();

/ --------- /</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-2">
                <div class="band-inner">

                  <p>sometimes U need to be more creative and instead spying is to create a DOM element and send it to test. The example could be 
                 React.createRef() for class object.</p>
                  <div class="codeWraper">
                    <code>-------- original class method being tested -----

scrollParagraph = () =&gt; {
    const node = this.myRef.current;
    node.scroll({
      left: 300,
      behavior: &quot;smooth&quot;,
    });
  };

-----------------


1. /- crate mock react reference

const mockRef = (instance) =&gt; {

  //create myRef as mock
  instance.myRef.current = document.createElement(&quot;div&quot;);
  instance.myRef.current.scroll = jest.fn();
  instance.scrollParagraph = jest.fn();
  instance.scrollWindow = jest.fn();

};

2. /- test file with mock this.myRef

it(&quot;scrolls container after click button action&quot;, () =&gt; {

  const wrapper = shallow(ProposalClassProperties /&gt;);
  const instance = wrapper.instance();

  //mock createRef helper function
  mockRef(instance);

  const btnActionScroll = wrapper.find(&quot;button&quot;);
  btnActionScroll.simulate(&quot;click&quot;);

  //assertions
  expect(instance.scrollParagraph).toHaveBeenCalled();
});

/-----/</code>
                  </div>
                </div>
              </div>
            

            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> jest.spyOn(object,method) as alternative to jest.mock() </h1> 
          
              <div class="band-container partition first" part="part-1">
                <div class="band-inner">

                  <p>Sometimes U dont want to go all of that trouble to mock entire module, U Want just to &#39;borrow&#39; or spy on one of its methods
                  and then restore its original functinality. Spies only work with moduels, classes basicaly objects.</p>
                  <div class="codeWraper">
                    <code>/-------------------------/

axios is module/object that comes with methods as get, post, put etc lets spy on get method only

1. /-- import your library as U would normally do 

-- import axios from &#39;axios&#39;

2. /---spyOn(object, method)  with mock implenation for it 

 -- jest.spyOn(axios, &quot;get&quot;).mockImplementation(() =&gt; Promise.resolve(&quot;hi&quot;));

3. /-- run you test with mock

axios.get().then((result) =&gt; {
  expect(result).toEqual(&quot;hi&quot;);
});

4. /-- lastly remmber to restore axios.get() to its original 

 -- axios.get.mockRestore()

/-------------------------/</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-2">
                <div class="band-inner">

                  <p>Spy itself allows you to spy on single method of a class as well. With mockImplementation()
              on spy You can change its original implemenation and then restore it. Example below</p>
                  <div class="codeWraper">
                    <code>------------------------ react Class example ---------------------

   class Counter extends Component {
    state = {
      count:0,
    }

    add = (val1,val2) =&gt; val1 + val2
  }



  1. /------------------ test with spyOn --------------------------

  it(&#39;should add two integers&#39;, () =&gt; {

    --- declare your wrapper first -----

    const wrapper = shallow(Counter /&gt;);


   2.  /--- assign your spy function on class instance only (WRAPPER WILL not work) ----

    const incrementSpyOn = jest.spyOn(
      wrapper.instance(),
      &#39;add&#39;
    ).mockImplementation(()=&gt;1)


   3. / ---- test your mock implemantion-----

    expect(wrapper.instance().add(2,3)).toEqual(1)


   4. / ---------- !!! the restore original implemenation !!! -----

    wrapper.instance().add.mockRestore() -- (dont put that line)


    5. /- (optional)---- now make sure your original implemenation works back on ----

    expect(wrapper.instance().add(2,3)).toEqual(5)

  });</code>
                  </div>
                </div>
              </div>
            

            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Mock Object methods </h1> 
          
              <div class="band-container partition first" part="part-1">
                <div class="band-inner">

                  <p>jest.spyOn to mock a funtion but later restore its original implementation</p>
                  <div class="codeWraper">
                    <code>----------------------- math.js object----------------
export default {
     add:(a, b) =&gt; a + b,
     subtract:(a, b) =&gt; b - a,
 })
 ---------------------------------------------------------

 1. /--- import your library like you would normaly do

import math from &#39;./math&#39;

 2. /-- spyOn your method object with mock implementation

     const addMock = jest.spyOn(math, &quot;add&quot;).mockImplementation(() =&gt; &quot;mock&quot;)

 3. /-- run your example test

     expect(addMock.add(1, 2)).toEqual(&quot;mock&quot;)

4. / ---------- !!! the restore original implemenation !!! -----

    addMock.mockRestore()

    //test expect(math.add(1, 2)).toEqual(3)

----------</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-2">
                <div class="band-inner">

                  <p>U can spy on the object properties and method and even assign temporarry get and set methods as shown below. The idea is to mock function as usual but then assing that function to set and get mehtod of the object</p>
                  <div class="codeWraper">
                    <code>----------  assign getTittle and setTitle methods----------  

const getTitle = jest.fn(() =&gt; &#39;pizza&#39;) //return type
const setTitle = jest.fn() //normal function no return 

--------- use your mock function in get and set Object properties-------------

const location = {}
Object.defineProperty(location, &#39;title&#39;, {
  get: getTitle,
  set: setTitle
})

---------- this syntax is from Jest 22.1.0+ -------------------

const location = {}
const getTitle = jest.spyOn(location, &#39;title&#39;, &#39;get&#39;).mockImplementation(() =&gt; &#39;pizza&#39;)
const setTitle = jest.spyOn(location, &#39;title&#39;, &#39;set&#39;).mockImplementation(() =&gt; {})


----------- restore to original functions ----------

---for one mock---

fn.mockClear() // Clears mock usage date (fn.mock.calls, fn.mock.instances)
fn.mockReset() // Clears and removes any mocked return values or implementations
fn.mockRestore() // Resets and restores the initial implementation


---------- for all mocks ----------

jest.clearAllMocks()
jest.resetAllMocks()
jest.restoreAllMocks()</code>
                  </div>
                </div>
              </div>
            

            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> clearing mocks </h1> 
          

            
              <div class="band-container">
                <div class="band-inner">

                  <p>When you run multiple test in one file U most likely want to spy, mock something in one test but restore for next one.Those are jest 
              clearing methods.</p>
                  <div class="codeWraper">
                    <code>----------- restore to original functions ----------

---for one mock---

fn.mockClear() // Clears mock usage date (fn.mock.calls, fn.mock.instances)
fn.mockReset() // Clears and removes any mocked return values or implementations
fn.mockRestore() // Resets and restores the initial implementation


---------- for all mocks ----------

jest.clearAllMocks()
jest.resetAllMocks()
jest.restoreAllMocks()</code>
                  </div>
                </div>
              </div>
            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> run only one test </h1> 
          

            
              <div class="band-container">
                <div class="band-inner">

                  <p>run only one specific test from CLI</p>
                  <div class="codeWraper">
                    <code>//it has to be cofigured so if you have seperate configuration use flag: 
--config=jest.configuration.json      

//command line
gilgrz$ /Users/gilgrz/myReactComponents/node_modules/.bin/jest -i &#39;absolutepath/AppRouter.test.js&#39;</code>
                  </div>
                </div>
              </div>
            

      </section>
  
  
    <section class="band band-b activeSection">
      <h1></h1>

      



        

    </section>
  
  </div>
</div>

       <!-- nunjucks loop-->
  </div>
</div>
<script src="scripts/nav-links.js"></script>
<script src="scripts/tooltips_links_over.js"></script>
<script src="scripts/search_nav.js"></script>
 </body></html>