<html lang="en"><head>
  <meta charset="UTF-8">  
  <title>tutorial === Layout</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/tutorial.css">
  <link rel="stylesheet" href="css/tooltip.css">
</head>
<body translate="no">
<div class="l-site">
  <div class="l-nav">
    <nav class="nav">
      <input type="text" placeholder="Search" id="search">
      <div style="clear: both;"></div>
      <!-- nunjucks loop-->
            
<ul class="links">
<!--list-tag-->
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Basics of JEST Framework</a><span class="tooltiptext">Basics of JEST Framework</span>
                  
                    <ul class="linksNested">
                          
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>naming and Folder convention</a><span class="tooltiptext">naming and Folder convention</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>instaling JEST</a><span class="tooltiptext">instaling JEST</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>testing Objects and arrays</a><span class="tooltiptext">testing Objects and arrays</span>
                        
                    </ul>
                
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Snapshot testing</a><span class="tooltiptext">Snapshot testing</span>
                  
                    <ul class="linksNested">
                          
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>react-test-renderer from JEST no event handlers support</a><span class="tooltiptext">react-test-renderer from JEST no event handlers support</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>ENZYME Configuration</a><span class="tooltiptext">ENZYME Configuration</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>Event simulators</a><span class="tooltiptext">Event simulators</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>shallow testing</a><span class="tooltiptext">shallow testing</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>Full dom Rendering enzyme mount();</a><span class="tooltiptext">Full dom Rendering enzyme mount();</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>Full render with Jsdom</a><span class="tooltiptext">Full render with Jsdom</span>
                        
                    </ul>
                
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Testing with Enzyme (cheat sheet link)</a><span class="tooltiptext">Testing with Enzyme (cheat sheet link)</span>
                 
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Testing original functions</a><span class="tooltiptext">Testing original functions</span>
                 
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Testing REDUX</a><span class="tooltiptext">Testing REDUX</span>
                  
                    <ul class="linksNested">
                          
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>redux-mock-store with thunk middleware</a><span class="tooltiptext">redux-mock-store with thunk middleware</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>redux-mock-store with saga middleware</a><span class="tooltiptext">redux-mock-store with saga middleware</span>
                        
                    </ul>
                
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">MOCK functions</a><span class="tooltiptext">MOCK functions</span>
                  
                    <ul class="linksNested">
                          
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>jest.fn();</a><span class="tooltiptext">jest.fn();</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>jest.fn() with function body</a><span class="tooltiptext">jest.fn() with function body</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>jest mock function with function body RETURN</a><span class="tooltiptext">jest mock function with function body RETURN</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>JEST function declaration helpers mockReturnValue nad mockReturnValueOnce</a><span class="tooltiptext">JEST function declaration helpers mockReturnValue nad mockReturnValueOnce</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>Overriding Mock function based on implemenations with mockImplementation()</a><span class="tooltiptext">Overriding Mock function based on implemenations with mockImplementation()</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>Jest.fn() mock that returns promise</a><span class="tooltiptext">Jest.fn() mock that returns promise</span>
                        
                    </ul>
                
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Mock entire modules/packages using jest.mock</a><span class="tooltiptext">Mock entire modules/packages using jest.mock</span>
                 
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">SpyOn Class methods</a><span class="tooltiptext">SpyOn Class methods</span>
                  
                    <ul class="linksNested">
                          
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>spyOn(wraper.instance(),&#39;class method&#39;) with arrow functions</a><span class="tooltiptext">spyOn(wraper.instance(),&#39;class method&#39;) with arrow functions</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>spyON(wraper.instance(), &#39;classMethod&#39;) with standard class methods</a><span class="tooltiptext">spyON(wraper.instance(), &#39;classMethod&#39;) with standard class methods</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>spyOn(wraper.instance(),&#39;class method&#39;) with .mockImplementation(()=&gt;&#39;whatever&#39;)</a><span class="tooltiptext">spyOn(wraper.instance(),&#39;class method&#39;) with .mockImplementation(()=&gt;&#39;whatever&#39;)</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>spyOn(wraper.instance(),&#39;class method&#39;) with .mockImplementationOnce(()=&gt;&#39;whatever&#39;)</a><span class="tooltiptext">spyOn(wraper.instance(),&#39;class method&#39;) with .mockImplementationOnce(()=&gt;&#39;whatever&#39;)</span>
                        
                    </ul>
                
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">Mock Object methods</a><span class="tooltiptext">Mock Object methods</span>
                  
                    <ul class="linksNested">
                          
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>jest.spyOn()</a><span class="tooltiptext">jest.spyOn()</span>
                           
                          <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts" partition>Object set get method using mock functions</a><span class="tooltiptext">Object set get method using mock functions</span>
                        
                    </ul>
                
      </li>
    
      <li class="nav-primary tooltip"><a href="javascript_tuts/tuts_all_scripts_css/test_jest_enzyme_tuts">run only one test</a><span class="tooltiptext">run only one test</span>
                 
      </li>
    
<!--end-list-tag-->
</ul>

       <!-- nunjucks loop-->
    </nav>
  </div>
  <div class="l-page">
    <div class="menu">
      <div class="menu-hamburger"></div>
    </div>
      <!-- nunjucks loop-->
          
<div class="sectionWrapper">
  <div class="sectionContainer">
   
      
      <section  class="band band-b activeSection"  class="band band-b">
          <h1> Basics of JEST Framework </h1> 
          
              <div class="band-container partition first" part="part-1">
                <div class="band-inner">

                  <p>U should create a sepearte folder for your test that follows the same structure as your src directory</p>
                  <div class="codeWraper">
                    <code>================ test folder structure  __tests__ ================

      Intresting fact if you create folder named : src/__tests__ jest will automatically detect that and uses this foler for running test on files.js inside , beside their names , no need to include filename.test.js it could be skipped

================ ================ ================</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-2">
                <div class="band-inner">

                  <p>jest is a testing framework ceated by facebook and covers most of the cases for testing react applications</p>
                  <div class="codeWraper">
                    <code>================ install JEST by ================

      npm i jest@20.0.4 (this version works with webpack 3 and babel6) latest version needs update on webpack and babel

================ to run ================

npm test (it will look for filenames with test in a name);


================ run only one test as  ================

npm test -- -t &#39;react Fragement&#39; 

will run this test(&#39;react Fragement&#39;, () =&gt; {}) so the discription of the test matters


================ to run with watch mode ================

npm test -- --watch 

================ to run a simple test ================ 

const add = (a,b)=&gt; a + b;

test(&#39;should add two numbers&#39;.; ()=&gt; {
const result = add(3,4)
//asserstion 
expect(result).toBe(7);
});
================ ================ ================</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-3">
                <div class="band-inner">

                  <p>in javascript {}==={} or []===[] are always false , the key is to test what is inside and array or object properties as below</p>
                  <div class="codeWraper">
                    <code>================ 2 objects ================ 

const obj1 = {name:&#39;Greg&#39;}
const obj2 = {name:&#39;Greg&#39;}

obj1===obj2 //false
JSON.stringify(obj1)===JSON.stringify(obj2) //true we comparing to strings

//jest 
describe(&#39;Objects are the same&#39;, () =&gt; {
test(&#39;have all the same properties&#39;, () =&gt; {
  expect(obj1).toEqual(obj2);
});
});


================ ================ ================</code>
                  </div>
                </div>
              </div>
            

            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Snapshot testing </h1> 
          
              <div class="band-container partition first" part="part-1">
                <div class="band-inner">

                  <p>There is a small package a 
  npm package called &#39;react-test-renderer&#39; for making your component snapshots. No need for Enzyme. BUT
  in only creates static snapshot it doesnt allow to test clicks, mouse events etc.</p>
                  <div class="codeWraper">
                    <code>================ instaling react-test-renderer ================

npm i react-test-renderer@16.0.0 (U need this version if you work with React 16.* )

================ example snapshot with JEST react-test-renderer no event handlers   ================

import React from &#39;react&#39;;
import Link from &#39;../Link.react&#39;;
import renderer from &#39;react-test-renderer&#39;;

it(&#39;renders correctly&#39;, () =&gt; {
  const tree = renderer
    .create(&lt;Link page=&quot;http://www.facebook.com&quot;&gt;Facebook&lt;/Link&gt;)
    .toJSON();
  expect(tree).toMatchSnapshot();
});

================ ================ ================</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-2">
                <div class="band-inner">

                  <p>Before U need &#39;Enzyme&#39; Airbnb product that is created to enhance testing for React, it uses addtional selectors and enables Snapshot testing, it needs special adapters to work with JEST
          ENZYME allows you to add event handlers of any types to your shallow wrappers.</p>
                  <div class="codeWraper">
                    <code>================ instaling enzyme ================

npm i --save-dev 
enzyme@3.0.0 
enzyme-adapter-react-16@1.7.1  (at least 1.7.* needed for react 16.8.4 with hooks)
enzyme-to-json@3.0.1 (package that allows you to render clean snapshot containing just Component JSX)
raf@3.3.2  (U need natitve request animation frame that is default in browser since IE 10 but we need that in testing enviroment )

================ configuration needed for Enzyme 3 ================

create a file for JEST configuration in a root of your project;

================ ================ ================ ================

----------------------root/jest.configuration.json--------------

{
  &quot;setupFiles&quot;:[
    &quot;raf/polyfill&quot;,
    &quot;&lt;rootDir&gt;/enzyme.configuration.js&quot;
  ]
}


//update to the file to have clean snapshot set without importing enzyme-to-json in every file
//so use that version 
{
    &quot;setupFiles&quot;: [
        &quot;raf/polyfill&quot;,
        &quot;&lt;rootDir&gt;/enzyme.configuration.js&quot;
    ],
    &quot;snapshotSerializers&quot;: [
        &quot;enzyme-to-json/serializer&quot;
    ]
}

================ ================ ================ ================

create a file for ENZYME configuration in a root directory;

================ ================ ================ ================

----------------------root/enzyme.configuration.js--------------

import Enzyme from &#39;enzyme&#39;;
import Adapter from &#39;enzyme-adapter-react-16&#39;;

Enzyme.configure({ adapter: new Adapter() });


================ ================ ================ ================

update your package.json with a path for jest configuration

================ ================ ================ ================

----------------------root/package.json--------------

&quot;scripts&quot;: {
    &quot;test&quot;: &quot;jest --config=jest.configuration.json&quot;
  },


---------------------------------------------------------------



import React from &#39;react&#39;;
import { shallow } from &#39;enzyme&#39;;
import MyComponent from &#39;./MyComponent&#39;;

describe(&#39;MyComponent&#39;, () =&gt; {
  it(&#39;should render correctly in &quot;debug&quot; mode&#39;, () =&gt; {
    const component = shallow(&lt;MyComponent debug /&gt;);
  
    expect(component).toMatchSnapshot();
  });
});

================ ================ ================</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-3">
                <div class="band-inner">

                  <p>Enzyme allows you to simulate events , could be any event as onLoad, click etc.. U need to find DOM element first and attach simulate as U would event as addEbentListener</p>
                  <div class="codeWraper">
                    <code>================ test click event and the outcome ================



//u need to mock your event handler method ( more about mocking in next section)
const eventHandlerCalled = jest.fn(); 

const value = &#39;myValue&#39;;
const wrapper = shallow(&lt;SearchBox
  label=&quot;label&quot;
  // e below is not a real event so if you need to use e.target.value you need to mock it
  eventHandler={e =&gt; (eventHandlerCalled(value))}
/&gt;);

// here we simulate onInput that needs to have event.target.value in handler method so we do;
wrapper.find(&#39;input&#39;).at(0).simulate(&#39;input&#39;, { target: { value } });

// fucntion is called after click;
expect(eventHandlerCalled).toHaveBeenCalledWith(value);




================  ================  ================  ================</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-4">
                <div class="band-inner">

                  <p>shallow testing allows U to render a component on one level , that means any tested components wont be rendered to the snapshot. It donsnt need any addtional library beside deafault jest and enzyme configuration.</p>
                  <div class="codeWraper">
                    <code>================= example of shalow Enzyme method to Snapshot =================

import React from &#39;react&#39;;
import { shallow } from &#39;enzyme&#39;;

// component for snapshot test;
import SimpleButton from &#39;../../../functional/Simplebutton&#39;;

test(&#39;renders correctly&#39;, () =&gt; {
  const wrapper = shallow(&lt;SimpleButton label=&quot;label&quot; action={() =&gt; {}} /&gt;);
  expect(wrapper).toMatchSnapshot();
});

================ ================ ================ ================</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-5">
                <div class="band-inner">

                  <p>U might need to render nested component for full DOM rendering, for that you also need to install a separate libraray , React reccomends jsdom</p>
                  <div class="codeWraper">
                    <code>===== To help you make up your mind, here is a list of APIs that need jsdom =======



-Any browser globals like window and document
-ReactDOM.render()
-TestUtils.renderIntoDocument() (a shortcut for the above)
-mount() in Enzyme




========== example of full rending is the same as shalow but full needs mount() =========

//no addtional configuration is needed Enzyme behind the scene is using jsdom , not external install nedeed;



import React from &#39;react&#39;;
import { shallow, mount } from &#39;enzyme&#39;;

/*
  *@this next line is defined in a root/jest.configuration.js
  *@so no need to import library
*/
// import toJson from &#39;enzyme-to-json&#39;;

// component for snapshot test;
import ToggleButton from &#39;../../../functional/Togglebutton&#39;;

test(&#39;renders correctly&#39;, () =&gt; {
  const wrapper = mount(&lt;ToggleButton
    action={() =&gt; {}}
    label=&quot;sort&quot;
    toggleLabels={[&#39;ASC&#39;, &#39;DESC&#39;]}
    values={[&#39;sortASC&#39;, &#39;sortDESC&#39;]}
  /&gt;);
  expect(wrapper).toMatchSnapshot();
});



============ ============ ============ ============</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-6">
                <div class="band-inner">

                  <p>U can use jsdom framework by creating browser enviroment, if U dont want to use Enzyme mount() method</p>
                  <div class="codeWraper">
                    <code>============ pure jsdom render no enzyme (not recommended) ============

import React from &#39;react&#39;;
import dom from &#39;jsdom&#39;;

test(&#39;User profile&#39;, () =&gt; {
  let component, dom;

  before((done) =&gt; {
    let person = { FirstName:&#39;Richard&#39;, LastName:&#39;Kotze&#39; };
    component = React.render(
      &lt;ProfileBox hint={person} /&gt;,
      document.body,
      () =&gt; {
        setTimeout(done);
      }
    );
  });

  after((done) =&gt; {
    React.unmountComponentAtNode(document.body);
    setTimeout(done);
  });

  expect(&#39;should contain name&#39;, () =&gt; {
    dom = React.findDOMNode(component);
    dom.textContent.should.containEql(&#39;Richard Kotze&#39;);
  });

});

============ ============ ============ ============</code>
                  </div>
                </div>
              </div>
            

            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Testing with Enzyme (cheat sheet link) </h1> 
          

            
              <div class="band-container">
                <div class="band-inner">

                  <p>Enzyme is air bng testing platform that works like jQuery for selecting the DOM structure captured in Enyzme snapshots</p>
                  <div class="codeWraper">
                    <code>/*Ezyme comes with lots of handy selectors which are all set in the link below*/

//copy that link below and paste in browser;

https://tutorial-set.herokuapp.com/views/javascript_tuts/test_jest_enzyme_tuts/Enzyme_cheatsheet.htm

or original one here:

https://devhints.io/enzyme</code>
                  </div>
                </div>
              </div>
            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Testing original functions </h1> 
          

            
              <div class="band-container">
                <div class="band-inner">

                  <p>the most common way of testing functionality of the method is simply run the method and 
                expect to give you back what is declared in function body (method has to be return type!) for that</p>
                  <div class="codeWraper">
                    <code>----------------------- math.js helpers ----------------
export const add      = (a, b) =&gt; a + b;
export const subtract = (a, b) =&gt; b - a;
---------------------------------------------------------

----------------------- app.js (math helpers implementation) ----------------
export const doAdd      = (a, b) =&gt; math.add(a, b);
export const doSubtract = (a, b) =&gt; math.subtract(a, b);
-----------------------------------------------------------------------------

--------------- now testing those implemenations --------------------------
import * as app from &quot;./app&quot;;
import * as math from &quot;./math&quot;;

/*
  *@test base function
  *@by running it
*/
test(&quot;calls math.add&quot;, () =&gt; {
    const add = math.add(1,2)
    expect(add).toBe(3)
})
/*
  *@test higher-order function
  *@by running it
*/
test(&quot;calls app.doAdd&quot;, () =&gt; {
    const appAdd = app.doAdd(1,2)
    expect(appAdd).toBe(3)
})
----------------------------------------------------------------------------</code>
                  </div>
                </div>
              </div>
            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Testing REDUX </h1> 
          
              <div class="band-container partition first" part="part-1">
                <div class="band-inner">

                  <p>redux-mock-store allows you to test thunk middleware and action creators as below</p>
                  <div class="codeWraper">
                    <code>/ --- confiture redux-mock-store --- /

import configureStore from &#39;redux-mock-store&#39; //ES6 modules
const { configureStore } = require(&#39;redux-mock-store&#39;) //CommonJS

const middlewares = [thunk]
const mockStore = configureStore(middlewares)

/ ------- /

/ --- then simply dispatch thunk function or action creator ---- /

store.dispatch(fetchData())

//---------------/

explanation:
There is no need to mock action creators that return type object {type:&#39;MY_ACTION_TYPE&#39;} this library will automatically detects and return in store.getActions() U might only mock if action creator dont return object 
or U want to mock entire seperate module that is part of your test code execution.</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-2">
                <div class="band-inner">

                  <p>redux-mock-store allows you to test thunk middleware and action creators as below</p>
                  <div class="codeWraper">
                    <code>/ --- confiture redux-mock-store --- /

import configureStore from &#39;redux-mock-store&#39; //ES6 modules
const { configureStore } = require(&#39;redux-mock-store&#39;) //CommonJS

const middlewares = [thunk]
const mockStore = configureStore(middlewares)

/ ------- /

/ --- then simply dispatch thunk function or action creator ---- /

store.dispatch(fetchData())

//---------------/

explanation:
There is no need to mock action creators that returns type object {type:&#39;MY_ACTION_TYPE&#39;} this library will automatically detects and return in store.getActions() U might only mock if action creator dont return object 
or U want to mock entire seperate module that is part of your test code execution.</code>
                  </div>
                </div>
              </div>
            

            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> MOCK functions </h1> 
          
              <div class="band-container partition first" part="part-1">
                <div class="band-inner">

                  <p>Every function can be assing to mock function. That way it will change its original functionality and will serve whaterver we declare in mock function body</p>
                  <div class="codeWraper">
                    <code>----------------- original apiService.get function -------

apiService.get = (a, b) =&gt; a + b;

--- Assign apiService.get to mock function (it will loose it original functionality)

apiService.get = jest.fn();

--jest.fn() is a normal function that doesnt return anything by default (as any js function)

console.log( apiService.get() )
//return undefined since fuction doesnt return anything


- then JEST comes with some testing methods to verirfy function is working -

//call funcion;
apiService.get();

//and expect
expect(apiService.get).toHaveBeenCalled();


- first call function and then test if function has been called twice with a param &#39;value&#39;-

apiService.get(&#39;value&#39;);

expect(apiService.get).toHaveBeenCalledTimes(2);
expect(apiService.get).toHaveBeenCalledWith(&#39;value&#39;);


------------------------- ---------------------- -------------------------</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-2">
                <div class="band-inner">

                  <p>techinally you can specify or call any function inside jest.fn() funtion body</p>
                  <div class="codeWraper">
                    <code>------------- call console once executing a mock function-----

apiService.get = jest.fn(console.log(&#39;working&#39;));


//call method
apiService.get()

---it will print to console but this is pointless cause it wont be testable cause jest.fn() do not return any value------</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-3">
                <div class="band-inner">

                  <p>jest.fn() can have function body which is a callback function jest.fn(callback) callback allows you to define what to return from function and what arguments to accept</p>
                  <div class="codeWraper">
                    <code>-------- jest.fn() function body as  (callback with return value)-----

 apiService.get = jest.fn(() =&gt; 2);

 //now call you mock
 console.log( apiService.get()) //return 2

- U can also pass arguments to your callback function -------

apiService.get = jest.fn((x) =&gt; x + 2);

console.log( apiService.get(2)) //return 4

 - Basically , U can do any trasformations inside your callback an then return any value you want and then verify in your acceptance criteria --

apiService.get = jest.fn((x) =&gt; x + 2 * 5 * 6);

--------- assertion to above -----------

expect(apiService.get(2)).toBe(62);

---------- ---------- ------------</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-4">
                <div class="band-inner">

                  <p>Jest comes with shorthand mock declaration that depends of your usage</p>
                  <div class="codeWraper">
                    <code>------below is the same statement with 2 ways of declaring ------

apiService.get = jest.fn(()=&gt;2) ===  apiService.getmockReturnValue(2)


------- you can specify what function return every time you call it ------

apiService.get
.mockReturnValueOnce(10)
.mockReturnValueOnce(10)
.mockReturnValue(20);

console.log(apiService.get());
console.log(apiService.get());
console.log(apiService.get());</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-5">
                <div class="band-inner">

                  <p>It is possible to declrae your mock functions more than once with diffrent result or implemenation</p>
                  <div class="codeWraper">
                    <code>------------- initial implementation ------------

apiService.get = jest.fn(()=&gt;2)

console.log(apiService.get()); //2

------ override initial implemation and chain multiple overrides  ------
apiService.get
.mockImplementationOnce(() =&gt; 52)
.mockImplementationOnce(() =&gt; 62)
.mockImplementation(() =&gt; true);


console.log(apiService.get()); //54
console.log(apiService.get()); //62
console.log(apiService.get()); //true

------------   ------------   ------------</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-6">
                <div class="band-inner">

                  <p>jest.fn() can return any value so We could introduce async code and return a Promise, usefull for testing HTTP calls</p>
                  <div class="codeWraper">
                    <code>----------------- original apiService.get function -------

apiService.get = (a, b) =&gt; a + b;

--- Assign apiService.get to mock function that returns Promise (it will loose it original functionality);

apiService.get = jest.fn(x =&gt; Promise.resolve(x));


-- make your assortion in Promise callback ----

  apiService.get(2).then((data) =&gt; {
    expect(data).toBe(2);
  });

----------  -----------  --------------</code>
                  </div>
                </div>
              </div>
            

            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Mock entire modules/packages using jest.mock </h1> 
          

            
              <div class="band-container">
                <div class="band-inner">

                  <p>/ --------------- /
  Sometimes you want to imoport a module as UserAuthorization  but dont want all complex validation U can just mock.
            There are 2 ways of mocking entire module.
      We can place our module on __MOCK__ directory , usefull for modules frequently used in tests modules  as
 fetch, axios etc... Then once is mocked in seperate directory then it will be used throughout. 
 Second method is to mock in testing file itself for modules used only for particular test.

/ --------------- /</p>
                  <div class="codeWraper">
                    <code>--------- original module  modalActions.js -------

export function showModal(children, options = {}) {
  const { mode, type } = options
  return (dispatch) =&gt; {
    dispatch(setModalCancelled(false))
    dispatch(setModalMode(mode || &#39;normal&#39;))
    dispatch(setModalChildren(children))
    dispatch(setModalType(type || &#39;dialog&#39;))
    dispatch(openModal())
  }
}
// we are intresting in mocking showModal (in practice we will mock entire module anyway cause jest will mock entire file)

/ --------------- /

 ----------------------- THERE ARE 2 WAYS OF MOCKING A MODULE ----------------


 1. By creating a folder __MOCKS__ and creating mock version of modalActions.js

 / --------------- /

 / ----- __MOCKS__/modalActions.js  ------ /

const showModal = jest.fn(() =&gt; ({ type: &#39;MOCK_SHOW_MODAL&#39; }))
export { showModal }

/ --------------- /

/---- in any test file as countryActions.spec.js  ------ /

jest.mock(&#39;../modalActions&#39;) 

/ --------------- /

explanation:
Simply import original module as above =&gt; jest will know is mocked since its mock version sits under the same name 
in __MOCKS__/modalActions.js

explanation:
Once is imported as jest.mock(&#39;../modalActions&#39;) is mocked with all method set in mock (dont need to call it either when test needs it it will run it as mock)

/ ------------------------------------------- /

2. By simply putting all above steps in below statement

/ --------------- /

/---- in any test file as countryActions.spec.js  ------ /

jest.mock(&#39;../modalActions&#39;, () =&gt; ({
  showModal: () =&gt; ({ type: &#39;MOCK_SHOW_MODAL&#39; }),
})) 

/ --------------- /

explanation:
Once is imported as above is mocked with all methods set in mock callback (showModal) (dont need to call it either when test needs it it will run it as mock)

/------------------ /</code>
                  </div>
                </div>
              </div>
            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> SpyOn Class methods </h1> 
          
              <div class="band-container partition first" part="part-1">
                <div class="band-inner">

                  <p>by using modern ES6 class syntax U have to test it differentlly to standard method declaration
              Spy itself allows you to spy on single method. !! IMPORTANT !! with arrow function declaration You wont be
              able to use enzyme click simulation, but only call class method itself</p>
                  <div class="codeWraper">
                    <code>------------------------ react Class example ---------------------

             class Counter extends Component {
              state = {
                count:0,
              }
              incrementCounter = () =&gt; {
                this.setState({ count:this.state.count++ } )
              }
              render(){
                button onClick={() =&gt; this.incrementCounter()} &gt;Increment button&gt;
              }
            }


            ------------------test with spyOn --------------------------

            it(&#39;should update the count by 1 once clicked&#39;, () =&gt; {

              --- declare your wrapper first -----

              const wrapper = shallow(Counter /&gt;);

              --- assign your spy function on INSTANCE CLASS ONLY (not a wrapper)----
                  (spyOn takes class Instance and name of the method for arrow functions)

              const incrementSpyOn = jest.spyOn(
                wrapper.instance(),
                &#39;incrementCounter&#39;
              )

              ---- call instance class literally ---
                (only this will work with arrow method declaration any onClick event will not trigger )-----

              wrapper.instance().incrementCounter()


              ----- expect increment by 1 ------

              expect(wrapper.state(&#39;counter&#39;)).toBe(1);
            });</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-2">
                <div class="band-inner">

                  <p>with a standard class methods, You need to bind your class functions in constructor in order
              to make them responsive to events(eg. clicks) in jest test for click simulation.

              constructor(props){
                super(props)
                this.method = this.method.bind(this)
              }</p>
                  <div class="codeWraper">
                    <code>------------------------ react Class example ---------------------

             class Counter extends Component {
              
              contstructor(props){
                super(props)
                this.state = {
                  count:0,
                }
                --- U have to bind your method for jest ----

                this.incrementCounter = this.incrementCounter.bind(this)
              }

              incrementCounter(){
                this.setState({ count:this.state.count++ } )
              }

              render(){
                button onClick={() =&gt; this.incrementCounter()} &gt;Increment button&gt;
              }
            }



            ------------------test with spyOn --------------------------

            it(&#39;should update the count by 1 once clicked&#39;, () =&gt; {


              --- assign your spy function on Class prototype first! ----
                  (spyOn takes class Prototype and name of the method for standard declaration)


              const incrementSpyOn = jest.spyOn(
                Counter.prototype,
                &#39;incrementCounter&#39;
              )


              -------- declare your shallow wrapper first-----

              const wrapper = shallow(Counter /&gt;);


              -------- then simulate click on wrapper child (NO NEED for class instance)-----

              wrapper.find(&#39;button&#39;).simulate(&#39;click&#39;);

              ------(or second way) find prop &#39;onClick&#39; and execute -----

              wrapper.find(&#39;button&#39;).prop(&#39;onClick&#39;)()



              ----- expect increment by 1 ------

              expect(wrapper.state(&#39;counter&#39;)).toBe(1);
            });</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-3">
                <div class="band-inner">

                  <p>Spy itself allows you to spy on single method. With mockImplementation()
              on spy You can change its original implemenation and then restore it. Example below</p>
                  <div class="codeWraper">
                    <code>------------------------ react Class example ---------------------

             class Counter extends Component {
              state = {
                count:0,
              }

              add = (val1,val2) =&gt; val1 + val2
            }



            ------------------ test with spyOn --------------------------

            it(&#39;should add two integers&#39;, () =&gt; {

              --- declare your wrapper first -----

              const wrapper = shallow(Counter /&gt;);


              --- assign your spy function on class instance only (WRAPPER WILL not work) ----

              const incrementSpyOn = jest.spyOn(
                wrapper.instance(),
                &#39;add&#39;
              ).mockImplementation(()=&gt;1)


              ---- call instance class literally -----

              expect(wrapper.instance().add(2,3)).toEqual(1)


              ---------- !!! the restore original implemenation !!! -----

              wrapper.instance().add.mockRestore() -- (dont put that line)


              ---- now make sure your original implemenation works back on ----

              expect(wrapper.instance().add(2,3)).toEqual(5)

            });</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-4">
                <div class="band-inner">

                  <p>Spy itself allows you to spy on single method. With mockImplementationOnce()
              on spy You can change its original implemenation but it will only works once no need to restore it.
              Example below</p>
                  <div class="codeWraper">
                    <code>------------------------ react Class example ---------------------

             class Counter extends Component {
              state = {
                count:0,
              }

              add = (val1,val2) =&gt; val1 + val2
            }



            ------------------test with spyOn --------------------------

            it(&#39;should add two integers&#39;, () =&gt; {


              --- declare your wrapper first -----

              const wrapper = shallow(Counter /&gt;);


              --- assign your spy function on class instance only not a wrapper ----

              const incrementSpyOn = jest.spyOn(
                wrapper.instance(),
                &#39;add&#39;
              ).mockImplementationOnce(()=&gt;1)


              ---- call instance class literally -----

              expect(wrapper.instance().add(2,3)).toEqual(1)


              ----------!!!! NO NEED to the restore original implemenation !!!!-----

              //wrapper.instance().add.mockRestore()


              ----now make sure your original implemenation works back on ----

              expect(wrapper.instance().add(2,3)).toEqual(5)

            });</code>
                  </div>
                </div>
              </div>
            

            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> Mock Object methods </h1> 
          
              <div class="band-container partition first" part="part-1">
                <div class="band-inner">

                  <p>jest.spyOn to mock a funtion but later restore its original implementation</p>
                  <div class="codeWraper">
                    <code>----------------------- math.js helpers ----------------
 export const add      = (a, b) =&gt; a + b;
 export const subtract = (a, b) =&gt; b - a;
 ---------------------------------------------------------

 describe(&quot;use js.spyOn() to mock function and then restore original implementation&quot;,()=&gt;{
     const addMock = jest.spyOn(math, &quot;add&quot;)

     // override the implementation
     addMock.mockImplementation(() =&gt; &quot;mock&quot;)
     expect(app.doAdd(1, 2)).toEqual(&quot;mock&quot;)

     // restore the original implementation
     addMock.mockRestore()
     expect(app.doAdd(1, 2)).toEqual(3)
 })</code>
                  </div>
                </div>
              </div>
            
              <div class="band-container partition " part="part-2">
                <div class="band-inner">

                  <p>U can spy on the object properties and method and even assign temporarry get and set methods as shown below. The idea is to mock function as usual but then assing that function to set and get mehtod of the object</p>
                  <div class="codeWraper">
                    <code>----------  assign getTittle and setTitle methods----------  

const getTitle = jest.fn(() =&gt; &#39;pizza&#39;) //return type
const setTitle = jest.fn() //normal function no return 

--------- use your mock function in get and set Object properties-------------

const location = {}
Object.defineProperty(location, &#39;title&#39;, {
  get: getTitle,
  set: setTitle
})

---------- this syntax is from Jest 22.1.0+ -------------------

const location = {}
const getTitle = jest.spyOn(location, &#39;title&#39;, &#39;get&#39;).mockImplementation(() =&gt; &#39;pizza&#39;)
const setTitle = jest.spyOn(location, &#39;title&#39;, &#39;set&#39;).mockImplementation(() =&gt; {})


----------- restore to original functions ----------

---for one mock---

fn.mockClear() // Clears mock usage date (fn.mock.calls, fn.mock.instances)
fn.mockReset() // Clears and removes any mocked return values or implementations
fn.mockRestore() // Resets and restores the initial implementation


---------- for all mocks ----------

jest.clearAllMocks()
jest.resetAllMocks()
jest.restoreAllMocks()</code>
                  </div>
                </div>
              </div>
            

            

      </section>
  
      
      <section   class="band band-b" class="band band-b">
          <h1> run only one test </h1> 
          

            
              <div class="band-container">
                <div class="band-inner">

                  <p>run only one specific test from CLI</p>
                  <div class="codeWraper">
                    <code>//it has to be cofigured so if you have seperate configuration use flag: 
--config=jest.configuration.json      

//command line
gilgrz$ /Users/gilgrz/myReactComponents/node_modules/.bin/jest -i &#39;AppRouter.test.js&#39;</code>
                  </div>
                </div>
              </div>
            

      </section>
  
  
    <section class="band band-b activeSection">
      <h1></h1>

      



        

    </section>
  
  </div>
</div>

       <!-- nunjucks loop-->
  </div>
</div>
<script src="scripts/nav-links.js"></script>
<script src="scripts/tooltips_links_over.js"></script>
<script src="scripts/search_nav.js"></script>
 </body></html>